var $s=Object.defineProperty;var Xs=(F,at,vt)=>at in F?$s(F,at,{enumerable:!0,configurable:!0,writable:!0,value:vt}):F[at]=vt;var _=(F,at,vt)=>(Xs(F,typeof at!="symbol"?at+"":at,vt),vt);(function(){"use strict";var F=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function at(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}function vt(n){if(n.__esModule)return n;var t=n.default;if(typeof t=="function"){var e=function r(){if(this instanceof r){var s=[null];s.push.apply(s,arguments);var i=Function.bind.apply(t,s);return new i}return t.apply(this,arguments)};e.prototype=t.prototype}else e={};return Object.defineProperty(e,"__esModule",{value:!0}),Object.keys(n).forEach(function(r){var s=Object.getOwnPropertyDescriptor(n,r);Object.defineProperty(e,r,s.get?s:{enumerable:!0,get:function(){return n[r]}})}),e}var Ye={},nt={},Ct={};Object.defineProperty(Ct,"__esModule",{value:!0}),Ct.DefaultSerializer=Ct.extendSerializer=void 0;function Fn(n,t){const e=n.deserialize.bind(n),r=n.serialize.bind(n);return{deserialize(s){return t.deserialize(s,e)},serialize(s){return t.serialize(s,r)}}}Ct.extendSerializer=Fn;const $e={deserialize(n){return Object.assign(Error(n.message),{name:n.name,stack:n.stack})},serialize(n){return{__error_marker:"$$error",message:n.message,name:n.name,stack:n.stack}}},Hn=n=>n&&typeof n=="object"&&"__error_marker"in n&&n.__error_marker==="$$error";Ct.DefaultSerializer={deserialize(n){return Hn(n)?$e.deserialize(n):n},serialize(n){return n instanceof Error?$e.serialize(n):n}},Object.defineProperty(nt,"__esModule",{value:!0}),nt.serialize=nt.deserialize=nt.registerSerializer=void 0;const Xe=Ct;let ie=Xe.DefaultSerializer;function Gn(n){ie=Xe.extendSerializer(ie,n)}nt.registerSerializer=Gn;function Wn(n){return ie.deserialize(n)}nt.deserialize=Wn;function Bn(n){return ie.serialize(n)}nt.serialize=Bn;var Ze={},ft={},Ht={};Object.defineProperty(Ht,"__esModule",{value:!0}),Ht.getBundleURL=Ht.getBaseURL=void 0;let be;function Un(){return be||(be=Vn()),be}Ht.getBundleURL=Un;function Vn(){try{throw new Error}catch(n){const t=(""+n.stack).match(/(https?|file|ftp|chrome-extension|moz-extension):\/\/[^)\n]+/g);if(t)return qe(t[0])}return"/"}function qe(n){return(""+n).replace(/^((?:https?|file|ftp|chrome-extension|moz-extension):\/\/.+)?\/[^/]+(?:\?.*)?$/,"$1")+"/"}Ht.getBaseURL=qe,Object.defineProperty(ft,"__esModule",{value:!0}),ft.isWorkerRuntime=ft.getWorkerImplementation=ft.defaultPoolSize=void 0;const Qe=Ht;ft.defaultPoolSize=typeof navigator<"u"&&navigator.hardwareConcurrency?navigator.hardwareConcurrency:4;const Je=n=>/^[a-zA-Z][a-zA-Z\d+\-.]*:/.test(n);function tn(n){const t=new Blob([n],{type:"application/javascript"});return URL.createObjectURL(t)}function jn(){if(typeof Worker>"u")return class{constructor(){throw Error("No web worker implementation available. You might have tried to spawn a worker within a worker in a browser that doesn't support workers in workers.")}};class n extends Worker{constructor(r,s){var i,a;typeof r=="string"&&s&&s._baseURL?r=new URL(r,s._baseURL):typeof r=="string"&&!Je(r)&&Qe.getBundleURL().match(/^file:\/\//i)&&(r=new URL(r,Qe.getBundleURL().replace(/\/[^\/]+$/,"/")),(!((i=s==null?void 0:s.CORSWorkaround)!==null&&i!==void 0)||i)&&(r=tn(`importScripts(${JSON.stringify(r)});`))),typeof r=="string"&&Je(r)&&(!((a=s==null?void 0:s.CORSWorkaround)!==null&&a!==void 0)||a)&&(r=tn(`importScripts(${JSON.stringify(r)});`)),super(r,s)}}class t extends n{constructor(r,s){const i=window.URL.createObjectURL(r);super(i,s)}static fromText(r,s){const i=new window.Blob([r],{type:"text/javascript"});return new t(i,s)}}return{blob:t,default:n}}let Se;function Kn(){return Se||(Se=jn()),Se}ft.getWorkerImplementation=Kn;function Yn(){const n=typeof self<"u"&&typeof Window<"u"&&self instanceof Window;return!!(typeof self<"u"&&self.postMessage&&!n)}ft.isWorkerRuntime=Yn;var en={},Gt={},$n={get exports(){return Gt},set exports(n){Gt=n}},Ae,nn;function Xn(){if(nn)return Ae;nn=1;var n=1e3,t=n*60,e=t*60,r=e*24,s=r*7,i=r*365.25;Ae=function(o,c){c=c||{};var d=typeof o;if(d==="string"&&o.length>0)return a(o);if(d==="number"&&isFinite(o))return c.long?h(o):u(o);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(o))};function a(o){if(o=String(o),!(o.length>100)){var c=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(o);if(c){var d=parseFloat(c[1]),f=(c[2]||"ms").toLowerCase();switch(f){case"years":case"year":case"yrs":case"yr":case"y":return d*i;case"weeks":case"week":case"w":return d*s;case"days":case"day":case"d":return d*r;case"hours":case"hour":case"hrs":case"hr":case"h":return d*e;case"minutes":case"minute":case"mins":case"min":case"m":return d*t;case"seconds":case"second":case"secs":case"sec":case"s":return d*n;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return d;default:return}}}}function u(o){var c=Math.abs(o);return c>=r?Math.round(o/r)+"d":c>=e?Math.round(o/e)+"h":c>=t?Math.round(o/t)+"m":c>=n?Math.round(o/n)+"s":o+"ms"}function h(o){var c=Math.abs(o);return c>=r?l(o,c,r,"day"):c>=e?l(o,c,e,"hour"):c>=t?l(o,c,t,"minute"):c>=n?l(o,c,n,"second"):o+" ms"}function l(o,c,d,f){var p=c>=d*1.5;return Math.round(o/d)+" "+f+(p?"s":"")}return Ae}function Zn(n){e.debug=e,e.default=e,e.coerce=h,e.disable=i,e.enable=s,e.enabled=a,e.humanize=Xn(),e.destroy=l,Object.keys(n).forEach(o=>{e[o]=n[o]}),e.names=[],e.skips=[],e.formatters={};function t(o){let c=0;for(let d=0;d<o.length;d++)c=(c<<5)-c+o.charCodeAt(d),c|=0;return e.colors[Math.abs(c)%e.colors.length]}e.selectColor=t;function e(o){let c,d=null,f,p;function x(...M){if(!x.enabled)return;const b=x,g=Number(new Date),E=g-(c||g);b.diff=E,b.prev=c,b.curr=g,c=g,M[0]=e.coerce(M[0]),typeof M[0]!="string"&&M.unshift("%O");let w=0;M[0]=M[0].replace(/%([a-zA-Z%])/g,(y,L)=>{if(y==="%%")return"%";w++;const R=e.formatters[L];if(typeof R=="function"){const m=M[w];y=R.call(b,m),M.splice(w,1),w--}return y}),e.formatArgs.call(b,M),(b.log||e.log).apply(b,M)}return x.namespace=o,x.useColors=e.useColors(),x.color=e.selectColor(o),x.extend=r,x.destroy=e.destroy,Object.defineProperty(x,"enabled",{enumerable:!0,configurable:!1,get:()=>d!==null?d:(f!==e.namespaces&&(f=e.namespaces,p=e.enabled(o)),p),set:M=>{d=M}}),typeof e.init=="function"&&e.init(x),x}function r(o,c){const d=e(this.namespace+(typeof c>"u"?":":c)+o);return d.log=this.log,d}function s(o){e.save(o),e.namespaces=o,e.names=[],e.skips=[];let c;const d=(typeof o=="string"?o:"").split(/[\s,]+/),f=d.length;for(c=0;c<f;c++)d[c]&&(o=d[c].replace(/\*/g,".*?"),o[0]==="-"?e.skips.push(new RegExp("^"+o.slice(1)+"$")):e.names.push(new RegExp("^"+o+"$")))}function i(){const o=[...e.names.map(u),...e.skips.map(u).map(c=>"-"+c)].join(",");return e.enable(""),o}function a(o){if(o[o.length-1]==="*")return!0;let c,d;for(c=0,d=e.skips.length;c<d;c++)if(e.skips[c].test(o))return!1;for(c=0,d=e.names.length;c<d;c++)if(e.names[c].test(o))return!0;return!1}function u(o){return o.toString().substring(2,o.toString().length-2).replace(/\.\*\?$/,"*")}function h(o){return o instanceof Error?o.stack||o.message:o}function l(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")}return e.enable(e.load()),e}var qn=Zn;(function(n,t){t.formatArgs=r,t.save=s,t.load=i,t.useColors=e,t.storage=a(),t.destroy=(()=>{let h=!1;return()=>{h||(h=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})(),t.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"];function e(){return typeof window<"u"&&window.process&&(window.process.type==="renderer"||window.process.__nwjs)?!0:typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/)?!1:typeof document<"u"&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||typeof window<"u"&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)}function r(h){if(h[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+h[0]+(this.useColors?"%c ":" ")+"+"+n.exports.humanize(this.diff),!this.useColors)return;const l="color: "+this.color;h.splice(1,0,l,"color: inherit");let o=0,c=0;h[0].replace(/%[a-zA-Z%]/g,d=>{d!=="%%"&&(o++,d==="%c"&&(c=o))}),h.splice(c,0,l)}t.log=console.debug||console.log||(()=>{});function s(h){try{h?t.storage.setItem("debug",h):t.storage.removeItem("debug")}catch{}}function i(){let h;try{h=t.storage.getItem("debug")}catch{}return!h&&typeof process<"u"&&"env"in process&&(h={}.DEBUG),h}function a(){try{return localStorage}catch{}}n.exports=qn(t);const{formatters:u}=n.exports;u.j=function(h){try{return JSON.stringify(h)}catch(l){return"[UnexpectedJSONParseError]: "+l.message}}})($n,Gt);var Qn=function(n,t,e,r){function s(i){return i instanceof e?i:new e(function(a){a(i)})}return new(e||(e=Promise))(function(i,a){function u(o){try{l(r.next(o))}catch(c){a(c)}}function h(o){try{l(r.throw(o))}catch(c){a(c)}}function l(o){o.done?i(o.value):s(o.value).then(u,h)}l((r=r.apply(n,t||[])).next())})};class oe{constructor(t){this._baseObserver=t,this._pendingPromises=new Set}complete(){Promise.all(this._pendingPromises).then(()=>this._baseObserver.complete()).catch(t=>this._baseObserver.error(t))}error(t){this._baseObserver.error(t)}schedule(t){const e=Promise.all(this._pendingPromises),r=[],s=a=>r.push(a),i=Promise.resolve().then(()=>Qn(this,void 0,void 0,function*(){yield e,yield t(s),this._pendingPromises.delete(i);for(const a of r)this._baseObserver.next(a)})).catch(a=>{this._pendingPromises.delete(i),this._baseObserver.error(a)});this._pendingPromises.add(i)}}const rn=()=>typeof Symbol=="function",Xt=n=>rn()&&!!Symbol[n],Me=n=>Xt(n)?Symbol[n]:"@@"+n;Xt("asyncIterator")||(Symbol.asyncIterator=Symbol.asyncIterator||Symbol.for("Symbol.asyncIterator"));const Jn=Me("iterator"),we=Me("observable"),sn=Me("species");function ae(n,t){const e=n[t];if(e!=null){if(typeof e!="function")throw new TypeError(e+" is not a function");return e}}function Zt(n){let t=n.constructor;return t!==void 0&&(t=t[sn],t===null&&(t=void 0)),t!==void 0?t:rt}function tr(n){return n instanceof rt}function Wt(n){Wt.log?Wt.log(n):setTimeout(()=>{throw n},0)}function ce(n){Promise.resolve().then(()=>{try{n()}catch(t){Wt(t)}})}function on(n){const t=n._cleanup;if(t!==void 0&&(n._cleanup=void 0,!!t))try{if(typeof t=="function")t();else{const e=ae(t,"unsubscribe");e&&e.call(t)}}catch(e){Wt(e)}}function xe(n){n._observer=void 0,n._queue=void 0,n._state="closed"}function er(n){const t=n._queue;if(t){n._queue=void 0,n._state="ready";for(const e of t)if(an(n,e.type,e.value),n._state==="closed")break}}function an(n,t,e){n._state="running";const r=n._observer;try{const s=r?ae(r,t):void 0;switch(t){case"next":s&&s.call(r,e);break;case"error":if(xe(n),s)s.call(r,e);else throw e;break;case"complete":xe(n),s&&s.call(r);break}}catch(s){Wt(s)}n._state==="closed"?on(n):n._state==="running"&&(n._state="ready")}function Te(n,t,e){if(n._state!=="closed"){if(n._state==="buffering"){n._queue=n._queue||[],n._queue.push({type:t,value:e});return}if(n._state!=="ready"){n._state="buffering",n._queue=[{type:t,value:e}],ce(()=>er(n));return}an(n,t,e)}}class nr{constructor(t,e){this._cleanup=void 0,this._observer=t,this._queue=void 0,this._state="initializing";const r=new rr(this);try{this._cleanup=e.call(void 0,r)}catch(s){r.error(s)}this._state==="initializing"&&(this._state="ready")}get closed(){return this._state==="closed"}unsubscribe(){this._state!=="closed"&&(xe(this),on(this))}}class rr{constructor(t){this._subscription=t}get closed(){return this._subscription._state==="closed"}next(t){Te(this._subscription,"next",t)}error(t){Te(this._subscription,"error",t)}complete(){Te(this._subscription,"complete")}}class rt{constructor(t){if(!(this instanceof rt))throw new TypeError("Observable cannot be called as a function");if(typeof t!="function")throw new TypeError("Observable initializer must be a function");this._subscriber=t}subscribe(t,e,r){return(typeof t!="object"||t===null)&&(t={next:t,error:e,complete:r}),new nr(t,this._subscriber)}pipe(t,...e){let r=this;for(const s of[t,...e])r=s(r);return r}tap(t,e,r){const s=typeof t!="object"||t===null?{next:t,error:e,complete:r}:t;return new rt(i=>this.subscribe({next(a){s.next&&s.next(a),i.next(a)},error(a){s.error&&s.error(a),i.error(a)},complete(){s.complete&&s.complete(),i.complete()},start(a){s.start&&s.start(a)}}))}forEach(t){return new Promise((e,r)=>{if(typeof t!="function"){r(new TypeError(t+" is not a function"));return}function s(){i.unsubscribe(),e(void 0)}const i=this.subscribe({next(a){try{t(a,s)}catch(u){r(u),i.unsubscribe()}},error(a){r(a)},complete(){e(void 0)}})})}map(t){if(typeof t!="function")throw new TypeError(t+" is not a function");const e=Zt(this);return new e(r=>this.subscribe({next(s){let i=s;try{i=t(s)}catch(a){return r.error(a)}r.next(i)},error(s){r.error(s)},complete(){r.complete()}}))}filter(t){if(typeof t!="function")throw new TypeError(t+" is not a function");const e=Zt(this);return new e(r=>this.subscribe({next(s){try{if(!t(s))return}catch(i){return r.error(i)}r.next(s)},error(s){r.error(s)},complete(){r.complete()}}))}reduce(t,e){if(typeof t!="function")throw new TypeError(t+" is not a function");const r=Zt(this),s=arguments.length>1;let i=!1,a=e;return new r(u=>this.subscribe({next(h){const l=!i;if(i=!0,!l||s)try{a=t(a,h)}catch(o){return u.error(o)}else a=h},error(h){u.error(h)},complete(){if(!i&&!s)return u.error(new TypeError("Cannot reduce an empty sequence"));u.next(a),u.complete()}}))}concat(...t){const e=Zt(this);return new e(r=>{let s,i=0;function a(u){s=u.subscribe({next(h){r.next(h)},error(h){r.error(h)},complete(){i===t.length?(s=void 0,r.complete()):a(e.from(t[i++]))}})}return a(this),()=>{s&&(s.unsubscribe(),s=void 0)}})}flatMap(t){if(typeof t!="function")throw new TypeError(t+" is not a function");const e=Zt(this);return new e(r=>{const s=[],i=this.subscribe({next(u){let h;if(t)try{h=t(u)}catch(o){return r.error(o)}else h=u;const l=e.from(h).subscribe({next(o){r.next(o)},error(o){r.error(o)},complete(){const o=s.indexOf(l);o>=0&&s.splice(o,1),a()}});s.push(l)},error(u){r.error(u)},complete(){a()}});function a(){i.closed&&s.length===0&&r.complete()}return()=>{s.forEach(u=>u.unsubscribe()),i.unsubscribe()}})}[we](){return this}static from(t){const e=typeof this=="function"?this:rt;if(t==null)throw new TypeError(t+" is not an object");const r=ae(t,we);if(r){const s=r.call(t);if(Object(s)!==s)throw new TypeError(s+" is not an object");return tr(s)&&s.constructor===e?s:new e(i=>s.subscribe(i))}if(Xt("iterator")){const s=ae(t,Jn);if(s)return new e(i=>{ce(()=>{if(!i.closed){for(const a of s.call(t))if(i.next(a),i.closed)return;i.complete()}})})}if(Array.isArray(t))return new e(s=>{ce(()=>{if(!s.closed){for(const i of t)if(s.next(i),s.closed)return;s.complete()}})});throw new TypeError(t+" is not observable")}static of(...t){const e=typeof this=="function"?this:rt;return new e(r=>{ce(()=>{if(!r.closed){for(const s of t)if(r.next(s),r.closed)return;r.complete()}})})}static get[sn](){return this}}rn()&&Object.defineProperty(rt,Symbol("extensions"),{value:{symbol:we,hostReportError:Wt},configurable:!0});var Nt=rt;function Rt(n){typeof n=="function"?n():n&&typeof n.unsubscribe=="function"&&n.unsubscribe()}var sr=function(n,t,e,r){function s(i){return i instanceof e?i:new e(function(a){a(i)})}return new(e||(e=Promise))(function(i,a){function u(o){try{l(r.next(o))}catch(c){a(c)}}function h(o){try{l(r.throw(o))}catch(c){a(c)}}function l(o){o.done?i(o.value):s(o.value).then(u,h)}l((r=r.apply(n,t||[])).next())})};function ir(n){return t=>new Nt(e=>{const r=new oe(e),s=t.subscribe({complete(){r.complete()},error(i){r.error(i)},next(i){r.schedule(a=>sr(this,void 0,void 0,function*(){(yield n(i))&&a(i)}))}});return()=>Rt(s)})}function or(n){return n&&Xt("asyncIterator")&&n[Symbol.asyncIterator]}function ar(n){return n&&Xt("iterator")&&n[Symbol.iterator]}var cr=function(n,t,e,r){function s(i){return i instanceof e?i:new e(function(a){a(i)})}return new(e||(e=Promise))(function(i,a){function u(o){try{l(r.next(o))}catch(c){a(c)}}function h(o){try{l(r.throw(o))}catch(c){a(c)}}function l(o){o.done?i(o.value):s(o.value).then(u,h)}l((r=r.apply(n,t||[])).next())})},ur=function(n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t=n[Symbol.asyncIterator],e;return t?t.call(n):(n=typeof __values=="function"?__values(n):n[Symbol.iterator](),e={},r("next"),r("throw"),r("return"),e[Symbol.asyncIterator]=function(){return this},e);function r(i){e[i]=n[i]&&function(a){return new Promise(function(u,h){a=n[i](a),s(u,h,a.done,a.value)})}}function s(i,a,u,h){Promise.resolve(h).then(function(l){i({value:l,done:u})},a)}};function lr(n){return t=>new Nt(e=>{const r=new oe(e),s=t.subscribe({complete(){r.complete()},error(i){r.error(i)},next(i){r.schedule(a=>cr(this,void 0,void 0,function*(){var u,h;const l=yield n(i);if(ar(l)||or(l))try{for(var o=ur(l),c;c=yield o.next(),!c.done;){const d=c.value;a(d)}}catch(d){u={error:d}}finally{try{c&&!c.done&&(h=o.return)&&(yield h.call(o))}finally{if(u)throw u.error}}else l.map(d=>a(d))}))}});return()=>Rt(s)})}function hr(n){return new rt(t=>{let e=0;const r=setInterval(()=>{t.next(e++)},n);return()=>clearInterval(r)})}var dr=function(n,t,e,r){function s(i){return i instanceof e?i:new e(function(a){a(i)})}return new(e||(e=Promise))(function(i,a){function u(o){try{l(r.next(o))}catch(c){a(c)}}function h(o){try{l(r.throw(o))}catch(c){a(c)}}function l(o){o.done?i(o.value):s(o.value).then(u,h)}l((r=r.apply(n,t||[])).next())})};function fr(n){return t=>new Nt(e=>{const r=new oe(e),s=t.subscribe({complete(){r.complete()},error(i){r.error(i)},next(i){r.schedule(a=>dr(this,void 0,void 0,function*(){const u=yield n(i);a(u)}))}});return()=>Rt(s)})}function mr(...n){return n.length===0?rt.from([]):new rt(t=>{let e=0;const r=n.map(i=>i.subscribe({error(a){t.error(a),s()},next(a){t.next(a)},complete(){++e===n.length&&(t.complete(),s())}})),s=()=>{r.forEach(i=>Rt(i))};return s})}class _r extends Nt{constructor(){super(t=>(this._observers.add(t),()=>this._observers.delete(t))),this._observers=new Set}next(t){for(const e of this._observers)e.next(t)}error(t){for(const e of this._observers)e.error(t)}complete(){for(const t of this._observers)t.complete()}}var cn=_r;function pr(n){const t=new cn;let e,r=0;return new Nt(s=>{e||(e=n.subscribe(t));const i=t.subscribe(s);return r++,()=>{r--,i.unsubscribe(),r===0&&(Rt(e),e=void 0)}})}var yr=function(n,t,e,r){function s(i){return i instanceof e?i:new e(function(a){a(i)})}return new(e||(e=Promise))(function(i,a){function u(o){try{l(r.next(o))}catch(c){a(c)}}function h(o){try{l(r.throw(o))}catch(c){a(c)}}function l(o){o.done?i(o.value):s(o.value).then(u,h)}l((r=r.apply(n,t||[])).next())})};function Er(n,t){return e=>new Nt(r=>{let s,i=0;const a=new oe(r),u=e.subscribe({complete(){a.complete()},error(h){a.error(h)},next(h){a.schedule(l=>yr(this,void 0,void 0,function*(){s=yield n(i===0?typeof t>"u"?h:t:s,h,i++),l(s)}))}});return()=>Rt(u)})}var gr=Object.freeze({__proto__:null,Observable:Nt,Subject:cn,filter:ir,flatMap:lr,interval:hr,map:fr,merge:mr,multicast:pr,scan:Er,unsubscribe:Rt}),ue=vt(gr),le={};Object.defineProperty(le,"__esModule",{value:!0}),le.allSettled=void 0;function br(n){return Promise.all(n.map(t=>{const e=i=>({status:"fulfilled",value:i}),r=i=>({status:"rejected",reason:i}),s=Promise.resolve(t);try{return s.then(e,r)}catch(i){return Promise.reject(i)}}))}le.allSettled=br;var un={};(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.PoolEventType=void 0,function(t){t.initialized="initialized",t.taskCanceled="taskCanceled",t.taskCompleted="taskCompleted",t.taskFailed="taskFailed",t.taskQueued="taskQueued",t.taskQueueDrained="taskQueueDrained",t.taskStart="taskStart",t.terminated="terminated"}(n.PoolEventType||(n.PoolEventType={}))})(un);var qt={},Z={};Object.defineProperty(Z,"__esModule",{value:!0}),Z.$worker=Z.$transferable=Z.$terminate=Z.$events=Z.$errors=void 0,Z.$errors=Symbol("thread.errors"),Z.$events=Symbol("thread.events"),Z.$terminate=Symbol("thread.terminate"),Z.$transferable=Symbol("thread.transferable"),Z.$worker=Symbol("thread.worker"),Object.defineProperty(qt,"__esModule",{value:!0}),qt.Thread=void 0;const Le=Z;function ln(n){throw Error(n)}qt.Thread={errors(n){return n[Le.$errors]||ln("Error observable not found. Make sure to pass a thread instance as returned by the spawn() promise.")},events(n){return n[Le.$events]||ln("Events observable not found. Make sure to pass a thread instance as returned by the spawn() promise.")},terminate(n){return n[Le.$terminate]()}},function(n){var t=F&&F.__awaiter||function(b,g,E,w){function S(y){return y instanceof E?y:new E(function(L){L(y)})}return new(E||(E=Promise))(function(y,L){function R(T){try{A(w.next(T))}catch(C){L(C)}}function m(T){try{A(w.throw(T))}catch(C){L(C)}}function A(T){T.done?y(T.value):S(T.value).then(R,m)}A((w=w.apply(b,g||[])).next())})},e=F&&F.__importDefault||function(b){return b&&b.__esModule?b:{default:b}};Object.defineProperty(n,"__esModule",{value:!0}),n.Pool=n.Thread=n.PoolEventType=void 0;const r=e(Gt),s=ue,i=le,a=ft,u=un;Object.defineProperty(n,"PoolEventType",{enumerable:!0,get:function(){return u.PoolEventType}});const h=qt;Object.defineProperty(n,"Thread",{enumerable:!0,get:function(){return h.Thread}});let l=1;function o(b){const g=[];for(let E=0;E<b;E++)g.push(E);return g}function c(b){return new Promise(g=>setTimeout(g,b))}function d(b,g){return b.reduce((E,w)=>[...E,...g(w)],[])}function f(b){return b.replace(/\W/g," ").trim().replace(/\s+/g,"-")}function p(b,g){return o(g).map(()=>({init:b(),runningTasks:[]}))}class x{constructor(g,E){this.eventSubject=new s.Subject,this.initErrors=[],this.isClosing=!1,this.nextTaskID=1,this.taskQueue=[];const w=typeof E=="number"?{size:E}:E||{},{size:S=a.defaultPoolSize}=w;this.debug=r.default(`threads:pool:${f(w.name||String(l++))}`),this.options=w,this.workers=p(g,S),this.eventObservable=s.multicast(s.Observable.from(this.eventSubject)),Promise.all(this.workers.map(y=>y.init)).then(()=>this.eventSubject.next({type:u.PoolEventType.initialized,size:this.workers.length}),y=>{this.debug("Error while initializing pool worker:",y),this.eventSubject.error(y),this.initErrors.push(y)})}findIdlingWorker(){const{concurrency:g=1}=this.options;return this.workers.find(E=>E.runningTasks.length<g)}runPoolTask(g,E){return t(this,void 0,void 0,function*(){const w=this.workers.indexOf(g)+1;this.debug(`Running task #${E.id} on worker #${w}...`),this.eventSubject.next({type:u.PoolEventType.taskStart,taskID:E.id,workerID:w});try{const S=yield E.run(yield g.init);this.debug(`Task #${E.id} completed successfully`),this.eventSubject.next({type:u.PoolEventType.taskCompleted,returnValue:S,taskID:E.id,workerID:w})}catch(S){this.debug(`Task #${E.id} failed`),this.eventSubject.next({type:u.PoolEventType.taskFailed,taskID:E.id,error:S,workerID:w})}})}run(g,E){return t(this,void 0,void 0,function*(){const w=(()=>t(this,void 0,void 0,function*(){const S=()=>{g.runningTasks=g.runningTasks.filter(y=>y!==w)};yield c(0);try{yield this.runPoolTask(g,E)}finally{S(),this.isClosing||this.scheduleWork()}}))();g.runningTasks.push(w)})}scheduleWork(){this.debug("Attempt de-queueing a task in order to run it...");const g=this.findIdlingWorker();if(!g)return;const E=this.taskQueue.shift();if(!E){this.debug("Task queue is empty"),this.eventSubject.next({type:u.PoolEventType.taskQueueDrained});return}this.run(g,E)}taskCompletion(g){return new Promise((E,w)=>{const S=this.events().subscribe(y=>{y.type===u.PoolEventType.taskCompleted&&y.taskID===g?(S.unsubscribe(),E(y.returnValue)):y.type===u.PoolEventType.taskFailed&&y.taskID===g?(S.unsubscribe(),w(y.error)):y.type===u.PoolEventType.terminated&&(S.unsubscribe(),w(Error("Pool has been terminated before task was run.")))})})}settled(g=!1){return t(this,void 0,void 0,function*(){const E=()=>d(this.workers,y=>y.runningTasks),w=[],S=this.eventObservable.subscribe(y=>{y.type===u.PoolEventType.taskFailed&&w.push(y.error)});return this.initErrors.length>0?Promise.reject(this.initErrors[0]):g&&this.taskQueue.length===0?(yield i.allSettled(E()),w):(yield new Promise((y,L)=>{const R=this.eventObservable.subscribe({next(m){m.type===u.PoolEventType.taskQueueDrained&&(R.unsubscribe(),y(void 0))},error:L})}),yield i.allSettled(E()),S.unsubscribe(),w)})}completed(g=!1){return t(this,void 0,void 0,function*(){const E=this.settled(g),w=new Promise((y,L)=>{const R=this.eventObservable.subscribe({next(m){m.type===u.PoolEventType.taskQueueDrained?(R.unsubscribe(),y(E)):m.type===u.PoolEventType.taskFailed&&(R.unsubscribe(),L(m.error))},error:L})}),S=yield Promise.race([E,w]);if(S.length>0)throw S[0]})}events(){return this.eventObservable}queue(g){const{maxQueuedJobs:E=1/0}=this.options;if(this.isClosing)throw Error("Cannot schedule pool tasks after terminate() has been called.");if(this.initErrors.length>0)throw this.initErrors[0];const w=this.nextTaskID++,S=this.taskCompletion(w);S.catch(L=>{this.debug(`Task #${w} errored:`,L)});const y={id:w,run:g,cancel:()=>{this.taskQueue.indexOf(y)!==-1&&(this.taskQueue=this.taskQueue.filter(L=>L!==y),this.eventSubject.next({type:u.PoolEventType.taskCanceled,taskID:y.id}))},then:S.then.bind(S)};if(this.taskQueue.length>=E)throw Error(`Maximum number of pool tasks queued. Refusing to queue another one.
This usually happens for one of two reasons: We are either at peak workload right now or some tasks just won't finish, thus blocking the pool.`);return this.debug(`Queueing task #${y.id}...`),this.taskQueue.push(y),this.eventSubject.next({type:u.PoolEventType.taskQueued,taskID:y.id}),this.scheduleWork(),y}terminate(g){return t(this,void 0,void 0,function*(){this.isClosing=!0,g||(yield this.completed(!0)),this.eventSubject.next({type:u.PoolEventType.terminated,remainingQueue:[...this.taskQueue]}),this.eventSubject.complete(),yield Promise.all(this.workers.map(E=>t(this,void 0,void 0,function*(){return h.Thread.terminate(yield E.init)})))})}}x.EventType=u.PoolEventType;function M(b,g){return new x(b,g)}M.EventType=u.PoolEventType,n.Pool=M}(en);var he={},de={};Object.defineProperty(de,"__esModule",{value:!0}),de.createPromiseWithResolver=void 0;const Sr=()=>{};function Ar(){let n=!1,t,e=Sr;return[new Promise(i=>{n?i(t):e=i}),i=>{n=!0,t=i,e(t)}]}de.createPromiseWithResolver=Ar;var hn={};(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.WorkerEventType=void 0,function(t){t.internalError="internalError",t.message="message",t.termination="termination"}(n.WorkerEventType||(n.WorkerEventType={}))})(hn);var Bt={},fe={};Object.defineProperty(fe,"__esModule",{value:!0}),fe.ObservablePromise=void 0;const Mr=ue,wr=()=>{},xr=n=>n,dn=n=>Promise.resolve().then(n);function Tr(n){throw n}function Lr(n){return n&&typeof n.then=="function"}class Ie extends Mr.Observable{constructor(t){super(e=>{const r=this,s=Object.assign(Object.assign({},e),{complete(){e.complete(),r.onCompletion()},error(i){e.error(i),r.onError(i)},next(i){e.next(i),r.onNext(i)}});try{return this.initHasRun=!0,t(s)}catch(i){s.error(i)}}),this.initHasRun=!1,this.fulfillmentCallbacks=[],this.rejectionCallbacks=[],this.firstValueSet=!1,this.state="pending"}onNext(t){this.firstValueSet||(this.firstValue=t,this.firstValueSet=!0)}onError(t){this.state="rejected",this.rejection=t;for(const e of this.rejectionCallbacks)dn(()=>e(t))}onCompletion(){this.state="fulfilled";for(const t of this.fulfillmentCallbacks)dn(()=>t(this.firstValue))}then(t,e){const r=t||xr,s=e||Tr;let i=!1;return new Promise((a,u)=>{const h=o=>{if(!i){i=!0;try{a(s(o))}catch(c){u(c)}}},l=o=>{try{a(r(o))}catch(c){h(c)}};if(this.initHasRun||this.subscribe({error:h}),this.state==="fulfilled")return a(r(this.firstValue));if(this.state==="rejected")return i=!0,a(s(this.rejection));this.fulfillmentCallbacks.push(l),this.rejectionCallbacks.push(h)})}catch(t){return this.then(void 0,t)}finally(t){const e=t||wr;return this.then(r=>(e(),r),()=>e())}static from(t){return Lr(t)?new Ie(e=>{const r=i=>{e.next(i),e.complete()},s=i=>{e.error(i)};t.then(r,s)}):super.from(t)}}fe.ObservablePromise=Ie;var mt={};Object.defineProperty(mt,"__esModule",{value:!0}),mt.Transfer=mt.isTransferDescriptor=void 0;const fn=Z;function Ir(n){return!(!n||typeof n!="object")}function vr(n){return n&&typeof n=="object"&&n[fn.$transferable]}mt.isTransferDescriptor=vr;function Cr(n,t){if(!t){if(!Ir(n))throw Error();t=[n]}return{[fn.$transferable]:!0,send:n,transferables:t}}mt.Transfer=Cr;var ve={};(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.WorkerMessageType=n.MasterMessageType=void 0,function(t){t.cancel="cancel",t.run="run"}(n.MasterMessageType||(n.MasterMessageType={})),function(t){t.error="error",t.init="init",t.result="result",t.running="running",t.uncaughtError="uncaughtError"}(n.WorkerMessageType||(n.WorkerMessageType={}))})(ve);var Nr=F&&F.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(Bt,"__esModule",{value:!0}),Bt.createProxyModule=Bt.createProxyFunction=void 0;const Rr=Nr(Gt),mn=ue,Qt=nt,_n=fe,Or=mt,Jt=ve,pn=Rr.default("threads:master:messages");let zr=1;const kr=n=>Array.from(new Set(n)),Pr=n=>n&&n.type===Jt.WorkerMessageType.error,Dr=n=>n&&n.type===Jt.WorkerMessageType.result,Fr=n=>n&&n.type===Jt.WorkerMessageType.running;function Hr(n,t){return new mn.Observable(e=>{let r;const s=i=>{if(pn("Message from worker:",i.data),!(!i.data||i.data.uid!==t)){if(Fr(i.data))r=i.data.resultType;else if(Dr(i.data))r==="promise"?(typeof i.data.payload<"u"&&e.next(Qt.deserialize(i.data.payload)),e.complete(),n.removeEventListener("message",s)):(i.data.payload&&e.next(Qt.deserialize(i.data.payload)),i.data.complete&&(e.complete(),n.removeEventListener("message",s)));else if(Pr(i.data)){const a=Qt.deserialize(i.data.error);e.error(a),n.removeEventListener("message",s)}}};return n.addEventListener("message",s),()=>{if(r==="observable"||!r){const i={type:Jt.MasterMessageType.cancel,uid:t};n.postMessage(i)}n.removeEventListener("message",s)}})}function Gr(n){if(n.length===0)return{args:[],transferables:[]};const t=[],e=[];for(const r of n)Or.isTransferDescriptor(r)?(t.push(Qt.serialize(r.send)),e.push(...r.transferables)):t.push(Qt.serialize(r));return{args:t,transferables:e.length===0?e:kr(e)}}function yn(n,t){return(...e)=>{const r=zr++,{args:s,transferables:i}=Gr(e),a={type:Jt.MasterMessageType.run,uid:r,method:t,args:s};pn("Sending command to run function to worker:",a);try{n.postMessage(a,i)}catch(u){return _n.ObservablePromise.from(Promise.reject(u))}return _n.ObservablePromise.from(mn.multicast(Hr(n,r)))}}Bt.createProxyFunction=yn;function Wr(n,t){const e={};for(const r of t)e[r]=yn(n,r);return e}Bt.createProxyModule=Wr;var Ce=F&&F.__awaiter||function(n,t,e,r){function s(i){return i instanceof e?i:new e(function(a){a(i)})}return new(e||(e=Promise))(function(i,a){function u(o){try{l(r.next(o))}catch(c){a(c)}}function h(o){try{l(r.throw(o))}catch(c){a(c)}}function l(o){o.done?i(o.value):s(o.value).then(u,h)}l((r=r.apply(n,t||[])).next())})},Br=F&&F.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(he,"__esModule",{value:!0}),he.spawn=void 0;const Ne=Br(Gt),Ur=ue,Vr=nt,jr=de,me=Z,_e=hn,En=Bt,Kr=Ne.default("threads:master:messages"),Yr=Ne.default("threads:master:spawn"),gn=Ne.default("threads:master:thread-utils"),$r=n=>n&&n.type==="init",Xr=n=>n&&n.type==="uncaughtError",Zr=typeof process<"u"&&{}.THREADS_WORKER_INIT_TIMEOUT?Number.parseInt({}.THREADS_WORKER_INIT_TIMEOUT,10):1e4;function qr(n,t,e){return Ce(this,void 0,void 0,function*(){let r;const s=new Promise((a,u)=>{r=setTimeout(()=>u(Error(e)),t)}),i=yield Promise.race([n,s]);return clearTimeout(r),i})}function Qr(n){return new Promise((t,e)=>{const r=s=>{Kr("Message from worker before finishing initialization:",s.data),$r(s.data)?(n.removeEventListener("message",r),t(s.data)):Xr(s.data)&&(n.removeEventListener("message",r),e(Vr.deserialize(s.data.error)))};n.addEventListener("message",r)})}function Jr(n,t){return new Ur.Observable(e=>{const r=i=>{const a={type:_e.WorkerEventType.message,data:i.data};e.next(a)},s=i=>{gn("Unhandled promise rejection event in thread:",i);const a={type:_e.WorkerEventType.internalError,error:Error(i.reason)};e.next(a)};n.addEventListener("message",r),n.addEventListener("unhandledrejection",s),t.then(()=>{const i={type:_e.WorkerEventType.termination};n.removeEventListener("message",r),n.removeEventListener("unhandledrejection",s),e.next(i),e.complete()})})}function ts(n){const[t,e]=jr.createPromiseWithResolver();return{terminate:()=>Ce(this,void 0,void 0,function*(){gn("Terminating worker"),yield n.terminate(),e()}),termination:t}}function bn(n,t,e,r){const s=e.filter(i=>i.type===_e.WorkerEventType.internalError).map(i=>i.error);return Object.assign(n,{[me.$errors]:s,[me.$events]:e,[me.$terminate]:r,[me.$worker]:t})}function es(n,t){return Ce(this,void 0,void 0,function*(){Yr("Initializing new thread");const e=t&&t.timeout?t.timeout:Zr,s=(yield qr(Qr(n),e,`Timeout: Did not receive an init message from worker after ${e}ms. Make sure the worker calls expose().`)).exposed,{termination:i,terminate:a}=ts(n),u=Jr(n,i);if(s.type==="function"){const h=En.createProxyFunction(n);return bn(h,n,u,a)}else if(s.type==="module"){const h=En.createProxyModule(n,s.methods);return bn(h,n,u,a)}else{const h=s.type;throw Error(`Worker init message states unexpected type of expose(): ${h}`)}})}he.spawn=es,function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.Worker=n.BlobWorker=n.isWorkerRuntime=n.Thread=n.spawn=n.Pool=void 0;const t=ft;Object.defineProperty(n,"isWorkerRuntime",{enumerable:!0,get:function(){return t.isWorkerRuntime}});var e=en;Object.defineProperty(n,"Pool",{enumerable:!0,get:function(){return e.Pool}});var r=he;Object.defineProperty(n,"spawn",{enumerable:!0,get:function(){return r.spawn}});var s=qt;Object.defineProperty(n,"Thread",{enumerable:!0,get:function(){return s.Thread}}),n.BlobWorker=t.getWorkerImplementation().blob,n.Worker=t.getWorkerImplementation().default}(Ze);var Re={},ns=n=>n?typeof Symbol.observable=="symbol"&&typeof n[Symbol.observable]=="function"?n===n[Symbol.observable]():typeof n["@@observable"]=="function"?n===n["@@observable"]():!1:!1,Oe={};Object.defineProperty(Oe,"__esModule",{value:!0});const rs=function(){const t=typeof self<"u"&&typeof Window<"u"&&self instanceof Window;return!!(typeof self<"u"&&self.postMessage&&!t)},ss=function(t,e){self.postMessage(t,e)},is=function(t){const e=s=>{t(s.data)},r=()=>{self.removeEventListener("message",e)};return self.addEventListener("message",e),r};Oe.default={isWorkerRuntime:rs,postMessageToMaster:ss,subscribeToMasterMessages:is},function(n){var t=F&&F.__awaiter||function(m,A,T,C){function z(k){return k instanceof T?k:new T(function(P){P(k)})}return new(T||(T=Promise))(function(k,P){function U(K){try{et(C.next(K))}catch($){P($)}}function V(K){try{et(C.throw(K))}catch($){P($)}}function et(K){K.done?k(K.value):z(K.value).then(U,V)}et((C=C.apply(m,A||[])).next())})},e=F&&F.__importDefault||function(m){return m&&m.__esModule?m:{default:m}};Object.defineProperty(n,"__esModule",{value:!0}),n.expose=n.isWorkerRuntime=n.Transfer=n.registerSerializer=void 0;const r=e(ns),s=nt,i=mt,a=ve,u=e(Oe);var h=nt;Object.defineProperty(n,"registerSerializer",{enumerable:!0,get:function(){return h.registerSerializer}});var l=mt;Object.defineProperty(n,"Transfer",{enumerable:!0,get:function(){return l.Transfer}}),n.isWorkerRuntime=u.default.isWorkerRuntime;let o=!1;const c=new Map,d=m=>m&&m.type===a.MasterMessageType.cancel,f=m=>m&&m.type===a.MasterMessageType.run,p=m=>r.default(m)||x(m);function x(m){return m&&typeof m=="object"&&typeof m.subscribe=="function"}function M(m){return i.isTransferDescriptor(m)?{payload:m.send,transferables:m.transferables}:{payload:m,transferables:void 0}}function b(){const m={type:a.WorkerMessageType.init,exposed:{type:"function"}};u.default.postMessageToMaster(m)}function g(m){const A={type:a.WorkerMessageType.init,exposed:{type:"module",methods:m}};u.default.postMessageToMaster(A)}function E(m,A){const{payload:T,transferables:C}=M(A),z={type:a.WorkerMessageType.error,uid:m,error:s.serialize(T)};u.default.postMessageToMaster(z,C)}function w(m,A,T){const{payload:C,transferables:z}=M(T),k={type:a.WorkerMessageType.result,uid:m,complete:A?!0:void 0,payload:C};u.default.postMessageToMaster(k,z)}function S(m,A){const T={type:a.WorkerMessageType.running,uid:m,resultType:A};u.default.postMessageToMaster(T)}function y(m){try{const A={type:a.WorkerMessageType.uncaughtError,error:s.serialize(m)};u.default.postMessageToMaster(A)}catch(A){console.error(`Not reporting uncaught error back to master thread as it occured while reporting an uncaught error already.
Latest error:`,A,`
Original error:`,m)}}function L(m,A,T){return t(this,void 0,void 0,function*(){let C;try{C=A(...T)}catch(k){return E(m,k)}const z=p(C)?"observable":"promise";if(S(m,z),p(C)){const k=C.subscribe(P=>w(m,!1,s.serialize(P)),P=>{E(m,s.serialize(P)),c.delete(m)},()=>{w(m,!0),c.delete(m)});c.set(m,k)}else try{const k=yield C;w(m,!0,s.serialize(k))}catch(k){E(m,s.serialize(k))}})}function R(m){if(!u.default.isWorkerRuntime())throw Error("expose() called in the master thread.");if(o)throw Error("expose() called more than once. This is not possible. Pass an object to expose() if you want to expose multiple functions.");if(o=!0,typeof m=="function")u.default.subscribeToMasterMessages(A=>{f(A)&&!A.method&&L(A.uid,m,A.args.map(s.deserialize))}),b();else if(typeof m=="object"&&m){u.default.subscribeToMasterMessages(T=>{f(T)&&T.method&&L(T.uid,m[T.method],T.args.map(s.deserialize))});const A=Object.keys(m).filter(T=>typeof m[T]=="function");g(A)}else throw Error(`Invalid argument passed to expose(). Expected a function or an object, got: ${m}`);u.default.subscribeToMasterMessages(A=>{if(d(A)){const T=A.uid,C=c.get(T);C&&(C.unsubscribe(),c.delete(T))}})}n.expose=R,typeof self<"u"&&typeof self.addEventListener=="function"&&u.default.isWorkerRuntime()&&(self.addEventListener("error",m=>{setTimeout(()=>y(m.error||m),250)}),self.addEventListener("unhandledrejection",m=>{const A=m.reason;A&&typeof A.message=="string"&&setTimeout(()=>y(A),250)})),typeof process<"u"&&typeof process.on=="function"&&u.default.isWorkerRuntime()&&(process.on("uncaughtException",m=>{setTimeout(()=>y(m),250)}),process.on("unhandledRejection",m=>{m&&typeof m.message=="string"&&setTimeout(()=>y(m),250)}))}(Re);var ze=at(Re);(function(n){var t=F&&F.__createBinding||(Object.create?function(u,h,l,o){o===void 0&&(o=l),Object.defineProperty(u,o,{enumerable:!0,get:function(){return h[l]}})}:function(u,h,l,o){o===void 0&&(o=l),u[o]=h[l]}),e=F&&F.__exportStar||function(u,h){for(var l in u)l!=="default"&&!Object.prototype.hasOwnProperty.call(h,l)&&t(h,u,l)};Object.defineProperty(n,"__esModule",{value:!0}),n.Transfer=n.DefaultSerializer=n.expose=n.registerSerializer=void 0;var r=nt;Object.defineProperty(n,"registerSerializer",{enumerable:!0,get:function(){return r.registerSerializer}}),e(Ze,n);var s=Re;Object.defineProperty(n,"expose",{enumerable:!0,get:function(){return s.expose}});var i=Ct;Object.defineProperty(n,"DefaultSerializer",{enumerable:!0,get:function(){return i.DefaultSerializer}});var a=mt;Object.defineProperty(n,"Transfer",{enumerable:!0,get:function(){return a.Transfer}})})(Ye);var gt=at(Ye);gt.registerSerializer,gt.spawn,gt.BlobWorker,gt.DefaultSerializer,gt.Pool,gt.Thread;const os=gt.Transfer;gt.Worker;const as=ze.expose;ze.registerSerializer,ze.Transfer;/**
 * @license
 * Copyright 2010-2022 Three.js Authors
 * SPDX-License-Identifier: MIT
 */const Sn="148",Y=["00","01","02","03","04","05","06","07","08","09","0a","0b","0c","0d","0e","0f","10","11","12","13","14","15","16","17","18","19","1a","1b","1c","1d","1e","1f","20","21","22","23","24","25","26","27","28","29","2a","2b","2c","2d","2e","2f","30","31","32","33","34","35","36","37","38","39","3a","3b","3c","3d","3e","3f","40","41","42","43","44","45","46","47","48","49","4a","4b","4c","4d","4e","4f","50","51","52","53","54","55","56","57","58","59","5a","5b","5c","5d","5e","5f","60","61","62","63","64","65","66","67","68","69","6a","6b","6c","6d","6e","6f","70","71","72","73","74","75","76","77","78","79","7a","7b","7c","7d","7e","7f","80","81","82","83","84","85","86","87","88","89","8a","8b","8c","8d","8e","8f","90","91","92","93","94","95","96","97","98","99","9a","9b","9c","9d","9e","9f","a0","a1","a2","a3","a4","a5","a6","a7","a8","a9","aa","ab","ac","ad","ae","af","b0","b1","b2","b3","b4","b5","b6","b7","b8","b9","ba","bb","bc","bd","be","bf","c0","c1","c2","c3","c4","c5","c6","c7","c8","c9","ca","cb","cc","cd","ce","cf","d0","d1","d2","d3","d4","d5","d6","d7","d8","d9","da","db","dc","dd","de","df","e0","e1","e2","e3","e4","e5","e6","e7","e8","e9","ea","eb","ec","ed","ee","ef","f0","f1","f2","f3","f4","f5","f6","f7","f8","f9","fa","fb","fc","fd","fe","ff"];let An=1234567;const Mn=Math.PI/180,wn=180/Math.PI;function cs(){const n=Math.random()*4294967295|0,t=Math.random()*4294967295|0,e=Math.random()*4294967295|0,r=Math.random()*4294967295|0;return(Y[n&255]+Y[n>>8&255]+Y[n>>16&255]+Y[n>>24&255]+"-"+Y[t&255]+Y[t>>8&255]+"-"+Y[t>>16&15|64]+Y[t>>24&255]+"-"+Y[e&63|128]+Y[e>>8&255]+"-"+Y[e>>16&255]+Y[e>>24&255]+Y[r&255]+Y[r>>8&255]+Y[r>>16&255]+Y[r>>24&255]).toLowerCase()}function ke(n,t,e){return Math.max(t,Math.min(e,n))}function xn(n,t){return(n%t+t)%t}function us(n,t,e,r,s){return r+(n-t)*(s-r)/(e-t)}function ls(n,t,e){return n!==t?(e-n)/(t-n):0}function Tn(n,t,e){return(1-e)*n+e*t}function hs(n,t,e,r){return Tn(n,t,1-Math.exp(-e*r))}function ds(n,t=1){return t-Math.abs(xn(n,t*2)-t)}function fs(n,t,e){return n<=t?0:n>=e?1:(n=(n-t)/(e-t),n*n*(3-2*n))}function ms(n,t,e){return n<=t?0:n>=e?1:(n=(n-t)/(e-t),n*n*n*(n*(n*6-15)+10))}function _s(n,t){return n+Math.floor(Math.random()*(t-n+1))}function ps(n,t){return n+Math.random()*(t-n)}function ys(n){return n*(.5-Math.random())}function Es(n){n!==void 0&&(An=n);let t=An+=1831565813;return t=Math.imul(t^t>>>15,t|1),t^=t+Math.imul(t^t>>>7,t|61),((t^t>>>14)>>>0)/4294967296}function gs(n){return n*Mn}function bs(n){return n*wn}function Ss(n){return(n&n-1)===0&&n!==0}function As(n){return Math.pow(2,Math.ceil(Math.log(n)/Math.LN2))}function Ms(n){return Math.pow(2,Math.floor(Math.log(n)/Math.LN2))}function ws(n,t,e,r,s){const i=Math.cos,a=Math.sin,u=i(e/2),h=a(e/2),l=i((t+r)/2),o=a((t+r)/2),c=i((t-r)/2),d=a((t-r)/2),f=i((r-t)/2),p=a((r-t)/2);switch(s){case"XYX":n.set(u*o,h*c,h*d,u*l);break;case"YZY":n.set(h*d,u*o,h*c,u*l);break;case"ZXZ":n.set(h*c,h*d,u*o,u*l);break;case"XZX":n.set(u*o,h*p,h*f,u*l);break;case"YXY":n.set(h*f,u*o,h*p,u*l);break;case"ZYZ":n.set(h*p,h*f,u*o,u*l);break;default:console.warn("THREE.MathUtils: .setQuaternionFromProperEuler() encountered an unknown order: "+s)}}function xs(n,t){switch(t.constructor){case Float32Array:return n;case Uint16Array:return n/65535;case Uint8Array:return n/255;case Int16Array:return Math.max(n/32767,-1);case Int8Array:return Math.max(n/127,-1);default:throw new Error("Invalid component type.")}}function Ts(n,t){switch(t.constructor){case Float32Array:return n;case Uint16Array:return Math.round(n*65535);case Uint8Array:return Math.round(n*255);case Int16Array:return Math.round(n*32767);case Int8Array:return Math.round(n*127);default:throw new Error("Invalid component type.")}}var Pe=Object.freeze({__proto__:null,DEG2RAD:Mn,RAD2DEG:wn,generateUUID:cs,clamp:ke,euclideanModulo:xn,mapLinear:us,inverseLerp:ls,lerp:Tn,damp:hs,pingpong:ds,smoothstep:fs,smootherstep:ms,randInt:_s,randFloat:ps,randFloatSpread:ys,seededRandom:Es,degToRad:gs,radToDeg:bs,isPowerOfTwo:Ss,ceilPowerOfTwo:As,floorPowerOfTwo:Ms,setQuaternionFromProperEuler:ws,normalize:Ts,denormalize:xs});class Ls{constructor(t=0,e=0,r=0,s=1){this.isQuaternion=!0,this._x=t,this._y=e,this._z=r,this._w=s}static slerpFlat(t,e,r,s,i,a,u){let h=r[s+0],l=r[s+1],o=r[s+2],c=r[s+3];const d=i[a+0],f=i[a+1],p=i[a+2],x=i[a+3];if(u===0){t[e+0]=h,t[e+1]=l,t[e+2]=o,t[e+3]=c;return}if(u===1){t[e+0]=d,t[e+1]=f,t[e+2]=p,t[e+3]=x;return}if(c!==x||h!==d||l!==f||o!==p){let M=1-u;const b=h*d+l*f+o*p+c*x,g=b>=0?1:-1,E=1-b*b;if(E>Number.EPSILON){const S=Math.sqrt(E),y=Math.atan2(S,b*g);M=Math.sin(M*y)/S,u=Math.sin(u*y)/S}const w=u*g;if(h=h*M+d*w,l=l*M+f*w,o=o*M+p*w,c=c*M+x*w,M===1-u){const S=1/Math.sqrt(h*h+l*l+o*o+c*c);h*=S,l*=S,o*=S,c*=S}}t[e]=h,t[e+1]=l,t[e+2]=o,t[e+3]=c}static multiplyQuaternionsFlat(t,e,r,s,i,a){const u=r[s],h=r[s+1],l=r[s+2],o=r[s+3],c=i[a],d=i[a+1],f=i[a+2],p=i[a+3];return t[e]=u*p+o*c+h*f-l*d,t[e+1]=h*p+o*d+l*c-u*f,t[e+2]=l*p+o*f+u*d-h*c,t[e+3]=o*p-u*c-h*d-l*f,t}get x(){return this._x}set x(t){this._x=t,this._onChangeCallback()}get y(){return this._y}set y(t){this._y=t,this._onChangeCallback()}get z(){return this._z}set z(t){this._z=t,this._onChangeCallback()}get w(){return this._w}set w(t){this._w=t,this._onChangeCallback()}set(t,e,r,s){return this._x=t,this._y=e,this._z=r,this._w=s,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(t){return this._x=t.x,this._y=t.y,this._z=t.z,this._w=t.w,this._onChangeCallback(),this}setFromEuler(t,e){const r=t._x,s=t._y,i=t._z,a=t._order,u=Math.cos,h=Math.sin,l=u(r/2),o=u(s/2),c=u(i/2),d=h(r/2),f=h(s/2),p=h(i/2);switch(a){case"XYZ":this._x=d*o*c+l*f*p,this._y=l*f*c-d*o*p,this._z=l*o*p+d*f*c,this._w=l*o*c-d*f*p;break;case"YXZ":this._x=d*o*c+l*f*p,this._y=l*f*c-d*o*p,this._z=l*o*p-d*f*c,this._w=l*o*c+d*f*p;break;case"ZXY":this._x=d*o*c-l*f*p,this._y=l*f*c+d*o*p,this._z=l*o*p+d*f*c,this._w=l*o*c-d*f*p;break;case"ZYX":this._x=d*o*c-l*f*p,this._y=l*f*c+d*o*p,this._z=l*o*p-d*f*c,this._w=l*o*c+d*f*p;break;case"YZX":this._x=d*o*c+l*f*p,this._y=l*f*c+d*o*p,this._z=l*o*p-d*f*c,this._w=l*o*c-d*f*p;break;case"XZY":this._x=d*o*c-l*f*p,this._y=l*f*c-d*o*p,this._z=l*o*p+d*f*c,this._w=l*o*c+d*f*p;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+a)}return e!==!1&&this._onChangeCallback(),this}setFromAxisAngle(t,e){const r=e/2,s=Math.sin(r);return this._x=t.x*s,this._y=t.y*s,this._z=t.z*s,this._w=Math.cos(r),this._onChangeCallback(),this}setFromRotationMatrix(t){const e=t.elements,r=e[0],s=e[4],i=e[8],a=e[1],u=e[5],h=e[9],l=e[2],o=e[6],c=e[10],d=r+u+c;if(d>0){const f=.5/Math.sqrt(d+1);this._w=.25/f,this._x=(o-h)*f,this._y=(i-l)*f,this._z=(a-s)*f}else if(r>u&&r>c){const f=2*Math.sqrt(1+r-u-c);this._w=(o-h)/f,this._x=.25*f,this._y=(s+a)/f,this._z=(i+l)/f}else if(u>c){const f=2*Math.sqrt(1+u-r-c);this._w=(i-l)/f,this._x=(s+a)/f,this._y=.25*f,this._z=(h+o)/f}else{const f=2*Math.sqrt(1+c-r-u);this._w=(a-s)/f,this._x=(i+l)/f,this._y=(h+o)/f,this._z=.25*f}return this._onChangeCallback(),this}setFromUnitVectors(t,e){let r=t.dot(e)+1;return r<Number.EPSILON?(r=0,Math.abs(t.x)>Math.abs(t.z)?(this._x=-t.y,this._y=t.x,this._z=0,this._w=r):(this._x=0,this._y=-t.z,this._z=t.y,this._w=r)):(this._x=t.y*e.z-t.z*e.y,this._y=t.z*e.x-t.x*e.z,this._z=t.x*e.y-t.y*e.x,this._w=r),this.normalize()}angleTo(t){return 2*Math.acos(Math.abs(ke(this.dot(t),-1,1)))}rotateTowards(t,e){const r=this.angleTo(t);if(r===0)return this;const s=Math.min(1,e/r);return this.slerp(t,s),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(t){return this._x*t._x+this._y*t._y+this._z*t._z+this._w*t._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let t=this.length();return t===0?(this._x=0,this._y=0,this._z=0,this._w=1):(t=1/t,this._x=this._x*t,this._y=this._y*t,this._z=this._z*t,this._w=this._w*t),this._onChangeCallback(),this}multiply(t){return this.multiplyQuaternions(this,t)}premultiply(t){return this.multiplyQuaternions(t,this)}multiplyQuaternions(t,e){const r=t._x,s=t._y,i=t._z,a=t._w,u=e._x,h=e._y,l=e._z,o=e._w;return this._x=r*o+a*u+s*l-i*h,this._y=s*o+a*h+i*u-r*l,this._z=i*o+a*l+r*h-s*u,this._w=a*o-r*u-s*h-i*l,this._onChangeCallback(),this}slerp(t,e){if(e===0)return this;if(e===1)return this.copy(t);const r=this._x,s=this._y,i=this._z,a=this._w;let u=a*t._w+r*t._x+s*t._y+i*t._z;if(u<0?(this._w=-t._w,this._x=-t._x,this._y=-t._y,this._z=-t._z,u=-u):this.copy(t),u>=1)return this._w=a,this._x=r,this._y=s,this._z=i,this;const h=1-u*u;if(h<=Number.EPSILON){const f=1-e;return this._w=f*a+e*this._w,this._x=f*r+e*this._x,this._y=f*s+e*this._y,this._z=f*i+e*this._z,this.normalize(),this._onChangeCallback(),this}const l=Math.sqrt(h),o=Math.atan2(l,u),c=Math.sin((1-e)*o)/l,d=Math.sin(e*o)/l;return this._w=a*c+this._w*d,this._x=r*c+this._x*d,this._y=s*c+this._y*d,this._z=i*c+this._z*d,this._onChangeCallback(),this}slerpQuaternions(t,e,r){return this.copy(t).slerp(e,r)}random(){const t=Math.random(),e=Math.sqrt(1-t),r=Math.sqrt(t),s=2*Math.PI*Math.random(),i=2*Math.PI*Math.random();return this.set(e*Math.cos(s),r*Math.sin(i),r*Math.cos(i),e*Math.sin(s))}equals(t){return t._x===this._x&&t._y===this._y&&t._z===this._z&&t._w===this._w}fromArray(t,e=0){return this._x=t[e],this._y=t[e+1],this._z=t[e+2],this._w=t[e+3],this._onChangeCallback(),this}toArray(t=[],e=0){return t[e]=this._x,t[e+1]=this._y,t[e+2]=this._z,t[e+3]=this._w,t}fromBufferAttribute(t,e){return this._x=t.getX(e),this._y=t.getY(e),this._z=t.getZ(e),this._w=t.getW(e),this}_onChange(t){return this._onChangeCallback=t,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._w}}class D{constructor(t=0,e=0,r=0){D.prototype.isVector3=!0,this.x=t,this.y=e,this.z=r}set(t,e,r){return r===void 0&&(r=this.z),this.x=t,this.y=e,this.z=r,this}setScalar(t){return this.x=t,this.y=t,this.z=t,this}setX(t){return this.x=t,this}setY(t){return this.y=t,this}setZ(t){return this.z=t,this}setComponent(t,e){switch(t){case 0:this.x=e;break;case 1:this.y=e;break;case 2:this.z=e;break;default:throw new Error("index is out of range: "+t)}return this}getComponent(t){switch(t){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+t)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(t){return this.x=t.x,this.y=t.y,this.z=t.z,this}add(t){return this.x+=t.x,this.y+=t.y,this.z+=t.z,this}addScalar(t){return this.x+=t,this.y+=t,this.z+=t,this}addVectors(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this.z=t.z+e.z,this}addScaledVector(t,e){return this.x+=t.x*e,this.y+=t.y*e,this.z+=t.z*e,this}sub(t){return this.x-=t.x,this.y-=t.y,this.z-=t.z,this}subScalar(t){return this.x-=t,this.y-=t,this.z-=t,this}subVectors(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this.z=t.z-e.z,this}multiply(t){return this.x*=t.x,this.y*=t.y,this.z*=t.z,this}multiplyScalar(t){return this.x*=t,this.y*=t,this.z*=t,this}multiplyVectors(t,e){return this.x=t.x*e.x,this.y=t.y*e.y,this.z=t.z*e.z,this}applyEuler(t){return this.applyQuaternion(Ln.setFromEuler(t))}applyAxisAngle(t,e){return this.applyQuaternion(Ln.setFromAxisAngle(t,e))}applyMatrix3(t){const e=this.x,r=this.y,s=this.z,i=t.elements;return this.x=i[0]*e+i[3]*r+i[6]*s,this.y=i[1]*e+i[4]*r+i[7]*s,this.z=i[2]*e+i[5]*r+i[8]*s,this}applyNormalMatrix(t){return this.applyMatrix3(t).normalize()}applyMatrix4(t){const e=this.x,r=this.y,s=this.z,i=t.elements,a=1/(i[3]*e+i[7]*r+i[11]*s+i[15]);return this.x=(i[0]*e+i[4]*r+i[8]*s+i[12])*a,this.y=(i[1]*e+i[5]*r+i[9]*s+i[13])*a,this.z=(i[2]*e+i[6]*r+i[10]*s+i[14])*a,this}applyQuaternion(t){const e=this.x,r=this.y,s=this.z,i=t.x,a=t.y,u=t.z,h=t.w,l=h*e+a*s-u*r,o=h*r+u*e-i*s,c=h*s+i*r-a*e,d=-i*e-a*r-u*s;return this.x=l*h+d*-i+o*-u-c*-a,this.y=o*h+d*-a+c*-i-l*-u,this.z=c*h+d*-u+l*-a-o*-i,this}project(t){return this.applyMatrix4(t.matrixWorldInverse).applyMatrix4(t.projectionMatrix)}unproject(t){return this.applyMatrix4(t.projectionMatrixInverse).applyMatrix4(t.matrixWorld)}transformDirection(t){const e=this.x,r=this.y,s=this.z,i=t.elements;return this.x=i[0]*e+i[4]*r+i[8]*s,this.y=i[1]*e+i[5]*r+i[9]*s,this.z=i[2]*e+i[6]*r+i[10]*s,this.normalize()}divide(t){return this.x/=t.x,this.y/=t.y,this.z/=t.z,this}divideScalar(t){return this.multiplyScalar(1/t)}min(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this.z=Math.min(this.z,t.z),this}max(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this.z=Math.max(this.z,t.z),this}clamp(t,e){return this.x=Math.max(t.x,Math.min(e.x,this.x)),this.y=Math.max(t.y,Math.min(e.y,this.y)),this.z=Math.max(t.z,Math.min(e.z,this.z)),this}clampScalar(t,e){return this.x=Math.max(t,Math.min(e,this.x)),this.y=Math.max(t,Math.min(e,this.y)),this.z=Math.max(t,Math.min(e,this.z)),this}clampLength(t,e){const r=this.length();return this.divideScalar(r||1).multiplyScalar(Math.max(t,Math.min(e,r)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(t){return this.x*t.x+this.y*t.y+this.z*t.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(t){return this.normalize().multiplyScalar(t)}lerp(t,e){return this.x+=(t.x-this.x)*e,this.y+=(t.y-this.y)*e,this.z+=(t.z-this.z)*e,this}lerpVectors(t,e,r){return this.x=t.x+(e.x-t.x)*r,this.y=t.y+(e.y-t.y)*r,this.z=t.z+(e.z-t.z)*r,this}cross(t){return this.crossVectors(this,t)}crossVectors(t,e){const r=t.x,s=t.y,i=t.z,a=e.x,u=e.y,h=e.z;return this.x=s*h-i*u,this.y=i*a-r*h,this.z=r*u-s*a,this}projectOnVector(t){const e=t.lengthSq();if(e===0)return this.set(0,0,0);const r=t.dot(this)/e;return this.copy(t).multiplyScalar(r)}projectOnPlane(t){return De.copy(this).projectOnVector(t),this.sub(De)}reflect(t){return this.sub(De.copy(t).multiplyScalar(2*this.dot(t)))}angleTo(t){const e=Math.sqrt(this.lengthSq()*t.lengthSq());if(e===0)return Math.PI/2;const r=this.dot(t)/e;return Math.acos(ke(r,-1,1))}distanceTo(t){return Math.sqrt(this.distanceToSquared(t))}distanceToSquared(t){const e=this.x-t.x,r=this.y-t.y,s=this.z-t.z;return e*e+r*r+s*s}manhattanDistanceTo(t){return Math.abs(this.x-t.x)+Math.abs(this.y-t.y)+Math.abs(this.z-t.z)}setFromSpherical(t){return this.setFromSphericalCoords(t.radius,t.phi,t.theta)}setFromSphericalCoords(t,e,r){const s=Math.sin(e)*t;return this.x=s*Math.sin(r),this.y=Math.cos(e)*t,this.z=s*Math.cos(r),this}setFromCylindrical(t){return this.setFromCylindricalCoords(t.radius,t.theta,t.y)}setFromCylindricalCoords(t,e,r){return this.x=t*Math.sin(e),this.y=r,this.z=t*Math.cos(e),this}setFromMatrixPosition(t){const e=t.elements;return this.x=e[12],this.y=e[13],this.z=e[14],this}setFromMatrixScale(t){const e=this.setFromMatrixColumn(t,0).length(),r=this.setFromMatrixColumn(t,1).length(),s=this.setFromMatrixColumn(t,2).length();return this.x=e,this.y=r,this.z=s,this}setFromMatrixColumn(t,e){return this.fromArray(t.elements,e*4)}setFromMatrix3Column(t,e){return this.fromArray(t.elements,e*3)}setFromEuler(t){return this.x=t._x,this.y=t._y,this.z=t._z,this}equals(t){return t.x===this.x&&t.y===this.y&&t.z===this.z}fromArray(t,e=0){return this.x=t[e],this.y=t[e+1],this.z=t[e+2],this}toArray(t=[],e=0){return t[e]=this.x,t[e+1]=this.y,t[e+2]=this.z,t}fromBufferAttribute(t,e){return this.x=t.getX(e),this.y=t.getY(e),this.z=t.getZ(e),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){const t=(Math.random()-.5)*2,e=Math.random()*Math.PI*2,r=Math.sqrt(1-t**2);return this.x=r*Math.cos(e),this.y=r*Math.sin(e),this.z=t,this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}}const De=new D,Ln=new Ls;class In{constructor(t=new D(1/0,1/0,1/0),e=new D(-1/0,-1/0,-1/0)){this.isBox3=!0,this.min=t,this.max=e}set(t,e){return this.min.copy(t),this.max.copy(e),this}setFromArray(t){let e=1/0,r=1/0,s=1/0,i=-1/0,a=-1/0,u=-1/0;for(let h=0,l=t.length;h<l;h+=3){const o=t[h],c=t[h+1],d=t[h+2];o<e&&(e=o),c<r&&(r=c),d<s&&(s=d),o>i&&(i=o),c>a&&(a=c),d>u&&(u=d)}return this.min.set(e,r,s),this.max.set(i,a,u),this}setFromBufferAttribute(t){let e=1/0,r=1/0,s=1/0,i=-1/0,a=-1/0,u=-1/0;for(let h=0,l=t.count;h<l;h++){const o=t.getX(h),c=t.getY(h),d=t.getZ(h);o<e&&(e=o),c<r&&(r=c),d<s&&(s=d),o>i&&(i=o),c>a&&(a=c),d>u&&(u=d)}return this.min.set(e,r,s),this.max.set(i,a,u),this}setFromPoints(t){this.makeEmpty();for(let e=0,r=t.length;e<r;e++)this.expandByPoint(t[e]);return this}setFromCenterAndSize(t,e){const r=Ot.copy(e).multiplyScalar(.5);return this.min.copy(t).sub(r),this.max.copy(t).add(r),this}setFromObject(t,e=!1){return this.makeEmpty(),this.expandByObject(t,e)}clone(){return new this.constructor().copy(this)}copy(t){return this.min.copy(t.min),this.max.copy(t.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(t){return this.isEmpty()?t.set(0,0,0):t.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(t){return this.isEmpty()?t.set(0,0,0):t.subVectors(this.max,this.min)}expandByPoint(t){return this.min.min(t),this.max.max(t),this}expandByVector(t){return this.min.sub(t),this.max.add(t),this}expandByScalar(t){return this.min.addScalar(-t),this.max.addScalar(t),this}expandByObject(t,e=!1){t.updateWorldMatrix(!1,!1);const r=t.geometry;if(r!==void 0)if(e&&r.attributes!=null&&r.attributes.position!==void 0){const i=r.attributes.position;for(let a=0,u=i.count;a<u;a++)Ot.fromBufferAttribute(i,a).applyMatrix4(t.matrixWorld),this.expandByPoint(Ot)}else r.boundingBox===null&&r.computeBoundingBox(),Fe.copy(r.boundingBox),Fe.applyMatrix4(t.matrixWorld),this.union(Fe);const s=t.children;for(let i=0,a=s.length;i<a;i++)this.expandByObject(s[i],e);return this}containsPoint(t){return!(t.x<this.min.x||t.x>this.max.x||t.y<this.min.y||t.y>this.max.y||t.z<this.min.z||t.z>this.max.z)}containsBox(t){return this.min.x<=t.min.x&&t.max.x<=this.max.x&&this.min.y<=t.min.y&&t.max.y<=this.max.y&&this.min.z<=t.min.z&&t.max.z<=this.max.z}getParameter(t,e){return e.set((t.x-this.min.x)/(this.max.x-this.min.x),(t.y-this.min.y)/(this.max.y-this.min.y),(t.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(t){return!(t.max.x<this.min.x||t.min.x>this.max.x||t.max.y<this.min.y||t.min.y>this.max.y||t.max.z<this.min.z||t.min.z>this.max.z)}intersectsSphere(t){return this.clampPoint(t.center,Ot),Ot.distanceToSquared(t.center)<=t.radius*t.radius}intersectsPlane(t){let e,r;return t.normal.x>0?(e=t.normal.x*this.min.x,r=t.normal.x*this.max.x):(e=t.normal.x*this.max.x,r=t.normal.x*this.min.x),t.normal.y>0?(e+=t.normal.y*this.min.y,r+=t.normal.y*this.max.y):(e+=t.normal.y*this.max.y,r+=t.normal.y*this.min.y),t.normal.z>0?(e+=t.normal.z*this.min.z,r+=t.normal.z*this.max.z):(e+=t.normal.z*this.max.z,r+=t.normal.z*this.min.z),e<=-t.constant&&r>=-t.constant}intersectsTriangle(t){if(this.isEmpty())return!1;this.getCenter(te),pe.subVectors(this.max,te),Ut.subVectors(t.a,te),Vt.subVectors(t.b,te),jt.subVectors(t.c,te),bt.subVectors(Vt,Ut),St.subVectors(jt,Vt),zt.subVectors(Ut,jt);let e=[0,-bt.z,bt.y,0,-St.z,St.y,0,-zt.z,zt.y,bt.z,0,-bt.x,St.z,0,-St.x,zt.z,0,-zt.x,-bt.y,bt.x,0,-St.y,St.x,0,-zt.y,zt.x,0];return!He(e,Ut,Vt,jt,pe)||(e=[1,0,0,0,1,0,0,0,1],!He(e,Ut,Vt,jt,pe))?!1:(ye.crossVectors(bt,St),e=[ye.x,ye.y,ye.z],He(e,Ut,Vt,jt,pe))}clampPoint(t,e){return e.copy(t).clamp(this.min,this.max)}distanceToPoint(t){return Ot.copy(t).clamp(this.min,this.max).sub(t).length()}getBoundingSphere(t){return this.getCenter(t.center),t.radius=this.getSize(Ot).length()*.5,t}intersect(t){return this.min.max(t.min),this.max.min(t.max),this.isEmpty()&&this.makeEmpty(),this}union(t){return this.min.min(t.min),this.max.max(t.max),this}applyMatrix4(t){return this.isEmpty()?this:(_t[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(t),_t[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(t),_t[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(t),_t[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(t),_t[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(t),_t[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(t),_t[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(t),_t[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(t),this.setFromPoints(_t),this)}translate(t){return this.min.add(t),this.max.add(t),this}equals(t){return t.min.equals(this.min)&&t.max.equals(this.max)}}const _t=[new D,new D,new D,new D,new D,new D,new D,new D],Ot=new D,Fe=new In,Ut=new D,Vt=new D,jt=new D,bt=new D,St=new D,zt=new D,te=new D,pe=new D,ye=new D,kt=new D;function He(n,t,e,r,s){for(let i=0,a=n.length-3;i<=a;i+=3){kt.fromArray(n,i);const u=s.x*Math.abs(kt.x)+s.y*Math.abs(kt.y)+s.z*Math.abs(kt.z),h=t.dot(kt),l=e.dot(kt),o=r.dot(kt);if(Math.max(-Math.max(h,l,o),Math.min(h,l,o))>u)return!1}return!0}typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:Sn}})),typeof window<"u"&&(window.__THREE__?console.warn("WARNING: Multiple instances of Three.js being imported."):window.__THREE__=Sn);const H=class{static getList(t){return t?t.split(",").map(e=>e.trim()):[]}static getBoolean(t,e){return t?t==="true":e}static getNumber(t){return parseFloat(t)}static getOptionalNumber(t){if(t)return parseFloat(t)}};let O=H;_(O,"LOG_LEVELS",H.getList({}.VITE_LOG_LEVELS)),_(O,"LOG_KEYS",H.getList({}.VITE_LOG_KEYS)),_(O,"JUMP_START",H.getBoolean({}.VITE_JUMP_START,!0)),_(O,"FOG_ENABLED",H.getBoolean({}.VITE_FOG_ENABLED,!0)),_(O,"EDITING_ENABLED",H.getBoolean({}.VITE_EDITING_ENABLED,!0)),_(O,"SHOW_INITIAL_TERRAIN_GENERATION",H.getBoolean({}.VITE_SHOW_INITIAL_TERRAIN_GENERATION,!1)),_(O,"SHOW_DEBUG_INFO",H.getBoolean({}.VITE_SHOW_DEBUG_UI,!1)),_(O,"SHOW_WINDOW_CLOSE_ALERT",H.getBoolean({}.VITE_SHOW_WINDOW_CLOSE_ALERT,!0)),_(O,"PLAYER_DEFAULT_PHYSICS_MODE",{}.VITE_PLAYER_DEFAULT_PHYSICS_MODE),_(O,"PLAYER_SHOW_BOUNDING_BOX",H.getBoolean({}.VITE_PLAYER_SHOW_BOUNDING_BOX,!1)),_(O,"CHUNK_WIDTH",H.getNumber({}.VITE_TERRAIN_CHUNK_WIDTH||20)),_(O,"CHUNK_HEIGHT",H.getNumber({}.VITE_TERRAIN_CHUNK_HEIGHT||6)),_(O,"CUSTOM_SEED",{}.VITE_CUSTOM_SEED||"map2"),_(O,"TERRAIN_GENERATION_ENABLED",H.getBoolean({}.VITE_TERRAIN_GENERATION_ENABLED,!0)),_(O,"TERRAIN_OPTIMIZATION_ENABLED",H.getBoolean({}.VITE_TERRAIN_OPTIMIZATION_ENABLED,!0)),_(O,"TREE_GENERATION_ENABLED",H.getBoolean({}.VITE_TREE_GENERATION_ENABLED,!0)),_(O,"DEFAULT_HORIZONTAL_RENDER_DISTANCE_IN_CHUNKS",H.getNumber({}.VITE_DEFAULT_HORIZONTAL_RENDER_DISTANCE_IN_CHUNKS)),_(O,"TOP_RENDER_DISTANCE_IN_CHUNKS",H.getNumber({}.VITE_TOP_RENDER_DISTANCE_IN_CHUNKS||8)),_(O,"BOTTOM_RENDER_DISTANCE_IN_CHUNKS",H.getNumber({}.VITE_BOTTOM_RENDER_DISTANCE_IN_CHUNKS||4)),_(O,"TESTING_MAP_ENABLED",H.getBoolean({}.VITE_TESTING_MAP_ENABLED,!1)),_(O,"TESTING_MAP_EROSION",H.getOptionalNumber({}.VITE_TESTING_MAP_EROSION)),_(O,"TESTING_MAP_CONTINENTALNESS",H.getOptionalNumber({}.VITE_TESTING_MAP_CONTINENTALNESS)),_(O,"TESTING_MAP_PV",H.getOptionalNumber({}.VITE_TESTING_MAP_PV)),_(O,"STARTING_INVENTORY_ITEMS",H.getList({}.VITE_STARTING_INVENTORY_ITEMS).map(t=>Number(t))),_(O,"STARTING_HOTBAR_ITEMS",H.getList({}.VITE_STARTING_HOTBAR_ITEMS).map(t=>Number(t)));const je=class{static debug(t,...e){}static info(t,...e){}static warn(t){}static error(t){}static shouldLog(t,...e){const r=je.LOG_LEVELS.includes(t);return e.some(i=>this.LOG_KEYS.includes(i))&&r}};let j=je;_(j,"LOG_LEVELS",O.LOG_LEVELS??["silent"]),_(j,"LOG_KEYS",O.LOG_KEYS),_(j,"GAME_LOOP_KEY","gameloop"),_(j,"SCENE_KEY","scene"),_(j,"AUDIO_KEY","audio"),_(j,"DATA_KEY","data"),_(j,"INPUT_KEY","input"),_(j,"MAP_KEY","map"),_(j,"COLLISION_KEY","collision"),_(j,"PLAYER_KEY","player"),_(j,"TERRAIN_KEY","terrain"),_(j,"CHUNK_KEY","chunk"),_(j,"INIT_KEY","init"),_(j,"LOADING_KEY","load"),_(j,"DISPOSE_KEY","dispose");const Pt={left:[-1,0,0],right:[1,0,0],top:[0,1,0],bottom:[0,-1,0],front:[0,0,1],back:[0,0,-1]},vn={left:{normal:Pt.left,vertices:[{pos:[0,1,0],uv:[0,1],ao:{corner:[-.5,-.5,.5],side1:[-.5,.5,-.5],side2:[-.5,-.5,-.5]}},{pos:[0,0,0],uv:[0,0],ao:{corner:[-.5,-.5,.5],side1:[-.5,.5,-.5],side2:[-.5,-.5,-.5]}},{pos:[0,1,1],uv:[1,1],ao:{corner:[-.5,.5,-.5],side1:[-.5,.5,.5],side2:[-.5,-.5,.5]}},{pos:[0,0,1],uv:[1,0],ao:{corner:[-.5,-.5,-.5],side1:[-.5,.5,.5],side2:[-.5,-.5,.5]}}]},right:{normal:Pt.right,vertices:[{pos:[1,1,1],uv:[0,1],ao:{corner:[.5,.5,-.5],side1:[.5,.5,.5],side2:[.5,-.5,.5]}},{pos:[1,0,1],uv:[0,0],ao:{corner:[.5,-.5,-.5],side1:[.5,.5,.5],side2:[.5,-.5,.5]}},{pos:[1,1,0],uv:[1,1],ao:{corner:[.5,.5,.5],side1:[.5,.5,-.5],side2:[.5,-.5,-.5]}},{pos:[1,0,0],uv:[1,0],ao:{corner:[.5,-.5,.5],side1:[.5,.5,-.5],side2:[.5,-.5,-.5]}}]},top:{normal:Pt.top,vertices:[{pos:[0,1,1],uv:[1,1],ao:{corner:[-.5,.5,.5],side1:[.5,.5,.5],side2:[-.5,.5,-.5]}},{pos:[1,1,1],uv:[0,1],ao:{corner:[.5,.5,.5],side1:[-.5,.5,.5],side2:[.5,.5,-.5]}},{pos:[0,1,0],uv:[1,0],ao:{corner:[-.5,.5,-.5],side1:[.5,.5,-.5],side2:[-.5,.5,.5]}},{pos:[1,1,0],uv:[0,0],ao:{corner:[.5,.5,-.5],side1:[-.5,.5,-.5],side2:[.5,.5,.5]}}]},bottom:{normal:Pt.bottom,vertices:[{pos:[1,0,1],uv:[1,0],ao:{corner:[.5,-.5,.5],side1:[-.5,-.5,.5],side2:[.5,-.5,-.5]}},{pos:[0,0,1],uv:[0,0],ao:{corner:[-.5,-.5,.5],side1:[.5,-.5,.5],side2:[-.5,-.5,.5]}},{pos:[1,0,0],uv:[1,1],ao:{corner:[.5,-.5,-.5],side1:[.5,-.5,.5],side2:[-.5,-.5,-.5]}},{pos:[0,0,0],uv:[0,1],ao:{corner:[-.5,-.5,-.5],side1:[.5,-.5,-.5],side2:[-.5,-.5,.5]}}]},front:{normal:Pt.front,vertices:[{pos:[0,0,1],uv:[0,0],ao:{corner:[.5,-.5,.5],side1:[-.5,.5,.5],side2:[-.5,-.5,.5]}},{pos:[1,0,1],uv:[1,0],ao:{corner:[-.5,-.5,.5],side1:[.5,.5,.5],side2:[.5,-.5,.5]}},{pos:[0,1,1],uv:[0,1],ao:{corner:[.5,.5,.5],side1:[-.5,-.5,.5],side2:[-.5,.5,.5]}},{pos:[1,1,1],uv:[1,1],ao:{corner:[-.5,.5,.5],side1:[.5,-.5,.5],side2:[.5,.5,.5]}}]},back:{normal:Pt.back,vertices:[{pos:[1,0,0],uv:[0,0],ao:{corner:[-.5,-.5,-.5],side1:[.5,.5,-.5],side2:[.5,-.5,-.5]}},{pos:[0,0,0],uv:[1,0],ao:{corner:[.5,-.5,-.5],side1:[-.5,.5,-.5],side2:[-.5,-.5,-.5]}},{pos:[1,1,0],uv:[0,1],ao:{corner:[-.5,.5,-.5],side1:[.5,.5,-.5],side2:[.5,-.5,-.5]}},{pos:[0,1,0],uv:[1,1],ao:{corner:[.5,.5,-.5],side1:[-.5,.5,-.5],side2:[-.5,-.5,-.5]}}]}},Cn=16,Is=256,vs=256;var B=(n=>(n[n.AIR=0]="AIR",n[n.CLOUD=1]="CLOUD",n[n.STONE=2]="STONE",n[n.COBBLESTONE=3]="COBBLESTONE",n[n.DIRT=4]="DIRT",n[n.GRASS=5]="GRASS",n[n.GRASS_SNOW=6]="GRASS_SNOW",n[n.WATER=7]="WATER",n[n.SAND=8]="SAND",n[n.GLASS=9]="GLASS",n[n.OAK_LOG=10]="OAK_LOG",n[n.OAK_LEAVES=11]="OAK_LEAVES",n[n.PLANKS=12]="PLANKS",n[n.COAL_ORE=13]="COAL_ORE",n[n.VENT=14]="VENT",n[n.VENT_2=15]="VENT_2",n[n.METAL_FLOOR_1=16]="METAL_FLOOR_1",n[n.METAL_FLOOR_2=17]="METAL_FLOOR_2",n[n.METAL_FLOOR_3=18]="METAL_FLOOR_3",n[n.METAL_PLATE_1=19]="METAL_PLATE_1",n[n.METAL_PLATE_2=20]="METAL_PLATE_2",n[n.METAL_PLATE_3=21]="METAL_PLATE_3",n[n.VENT_3=22]="VENT_3",n[n.METAL_FLOOR_4=23]="METAL_FLOOR_4",n[n.METAL_FLOOR_5=24]="METAL_FLOOR_5",n[n.METAL_FLOOR_RUSTY_1=25]="METAL_FLOOR_RUSTY_1",n[n.METAL_FLOOR_RUSTY_2=26]="METAL_FLOOR_RUSTY_2",n[n.METAL_FLOOR_RUSTY_3=27]="METAL_FLOOR_RUSTY_3",n[n.FLOOR_GREEN=28]="FLOOR_GREEN",n[n.FLOOR_BLUE=29]="FLOOR_BLUE",n[n.FLOOR_PURPLE=30]="FLOOR_PURPLE",n[n.FLOOR_GREEN_BLUE=31]="FLOOR_GREEN_BLUE",n[n.CRATE_1=32]="CRATE_1",n[n.METAL_WALL_1=33]="METAL_WALL_1",n[n.METAL_WALL_2=34]="METAL_WALL_2",n[n.GLASS_PURPLE=35]="GLASS_PURPLE",n[n.GLASS_PINK=36]="GLASS_PINK",n[n.GLASS_RED=37]="GLASS_RED",n[n.GLASS_BLUE=38]="GLASS_BLUE",n[n.METAL_FLOOR_6=39]="METAL_FLOOR_6",n[n.NONE=40]="NONE",n[n.SPAWNER_1=41]="SPAWNER_1",n[n.SPAWNER_2=42]="SPAWNER_2",n[n.METAL_PLATE_4=43]="METAL_PLATE_4",n[n.METAL_WALL_3=44]="METAL_WALL_3",n[n.BRICK_WALL_1=45]="BRICK_WALL_1",n[n.BRICK_WALL_2=46]="BRICK_WALL_2",n[n.BRICK_WALL_3=47]="BRICK_WALL_3",n[n.BRICK_WALL_4=48]="BRICK_WALL_4",n[n.BRICK_WALL_5=49]="BRICK_WALL_5",n[n.BRICK_WALL_6=50]="BRICK_WALL_6",n[n.BRICK_WALL_7=51]="BRICK_WALL_7",n[n.WOODEN_WALL_1=52]="WOODEN_WALL_1",n[n.WOODEN_WALL_2=53]="WOODEN_WALL_2",n[n.WOODEN_WALL_3=54]="WOODEN_WALL_3",n[n.CARPET_GREEN=55]="CARPET_GREEN",n[n.CARPET_BLUE=56]="CARPET_BLUE",n[n.CARPET_PURPLE=57]="CARPET_PURPLE",n[n.CARPET_DARK_BLUE=58]="CARPET_DARK_BLUE",n[n.CARPET_ORANGE=59]="CARPET_ORANGE",n[n.CARPET_YELLOW=60]="CARPET_YELLOW",n[n.CLEAN_BRICK_1=61]="CLEAN_BRICK_1",n[n.CLEAN_BRICK_2=62]="CLEAN_BRICK_2",n[n.WARNING=63]="WARNING",n))(B||{});class N{static AddSolidBlock(t,e,r,s,i,a,u,h,l){return{name:e,isTransparent:!1,isSolid:!0,drop:h,icon:a||{row:-1,col:-1},texture:{top:r,bottom:s||r,side:i||r},color:u,sounds:l}}static AddTransparentBlock(t,e,r,s,i,a,u,h,l){return{name:e,isTransparent:!0,isSolid:!0,drop:h,icon:a||{row:-1,col:-1},texture:{top:r,bottom:s||r,side:i||r},color:u,sounds:l}}}const v={[40]:{name:"_none",isTransparent:!0,isSolid:!1,icon:{row:-1,col:-1},texture:{top:{row:-1,col:-1},bottom:{row:-1,col:-1},side:{row:-1,col:-1}}},[0]:{name:"_air",isTransparent:!0,isSolid:!1,icon:{row:-1,col:-1},texture:{top:{row:-1,col:-1},bottom:{row:-1,col:-1},side:{row:-1,col:-1}}},[1]:{name:"cloud",isTransparent:!0,isSolid:!1,icon:{row:-1,col:-1},texture:{top:{row:2,col:5},bottom:{row:2,col:5},side:{row:2,col:5}},color:[1,1,1,.4]},[2]:{name:"Stone",isTransparent:!1,isSolid:!0,drop:3,icon:{row:18,col:12},texture:{top:{row:0,col:5},bottom:{row:0,col:5},side:{row:0,col:5}}},[3]:{name:"Cobblestone",isTransparent:!1,isSolid:!0,drop:3,icon:{row:8,col:31},texture:{top:{row:0,col:4},bottom:{row:0,col:4},side:{row:0,col:4}}},[5]:{name:"Grass",isTransparent:!1,isSolid:!0,drop:4,icon:{row:16,col:27},texture:{top:{row:0,col:1},bottom:{row:0,col:2},side:{row:0,col:0}}},[6]:{name:"Snow",isTransparent:!1,isSolid:!0,drop:4,icon:{row:13,col:18},texture:{top:{row:2,col:5},bottom:{row:0,col:2},side:{row:2,col:4}}},[4]:{name:"Dirt",isTransparent:!1,isSolid:!0,drop:4,icon:{row:13,col:18},texture:{top:{row:0,col:2},bottom:{row:0,col:2},side:{row:0,col:2}}},[10]:{name:"Oak_Log",isTransparent:!1,isSolid:!0,drop:10,icon:{row:25,col:9},texture:{top:{row:1,col:2},bottom:{row:1,col:2},side:{row:1,col:3}}},[11]:{name:"Oak_Leaves",isTransparent:!0,isSolid:!0,icon:{row:25,col:8},texture:{top:{row:1,col:5},bottom:{row:1,col:5},side:{row:1,col:5}}},[12]:{name:"Planks",isTransparent:!1,isSolid:!0,drop:12,icon:{row:25,col:10},texture:{top:{row:1,col:4},bottom:{row:1,col:4},side:{row:1,col:4}}},[8]:{name:"Sand",isTransparent:!1,isSolid:!0,drop:8,icon:{row:32,col:6},texture:{top:{row:1,col:6},bottom:{row:1,col:6},side:{row:1,col:6}}},[7]:{name:"Water",isTransparent:!0,isSolid:!1,icon:{row:37,col:28},texture:{side:{row:1,col:7},top:{row:1,col:7},bottom:{row:1,col:7}}},[9]:{name:"Glass",isTransparent:!0,isSolid:!0,icon:{row:15,col:26},texture:{side:{row:2,col:0},top:{row:2,col:0},bottom:{row:2,col:0}}},[13]:{name:"Coal_Ore",isTransparent:!1,isSolid:!0,drop:13,icon:{row:8,col:25},texture:{side:{row:0,col:6},top:{row:0,col:6},bottom:{row:0,col:6}}}};v[14]=N.AddSolidBlock(14,"VENT",{row:0,col:9},void 0,void 0),v[15]=N.AddSolidBlock(15,"VENT_2",{row:5,col:10},void 0,void 0),v[22]=N.AddSolidBlock(22,"VENT_3",{row:5,col:14},void 0,void 0),v[16]=N.AddSolidBlock(16,"METAL_FLOOR_1",{row:2,col:11},void 0,void 0),v[17]=N.AddSolidBlock(17,"METAL_FLOOR_2",{row:1,col:9},void 0,void 0),v[18]=N.AddSolidBlock(18,"METAL_FLOOR_3",{row:1,col:11},void 0,void 0),v[23]=N.AddSolidBlock(23,"METAL_FLOOR_4",{row:5,col:15},void 0,void 0),v[24]=N.AddSolidBlock(24,"METAL_FLOOR_5",{row:0,col:15},void 0,void 0),v[39]=N.AddSolidBlock(39,"METAL_FLOOR_6",{row:0,col:10},void 0,void 0),v[25]=N.AddSolidBlock(25,"METAL_FLOOR_RUSTY_1",{row:6,col:12},{row:6,col:12},{row:6,col:11}),v[26]=N.AddSolidBlock(26,"METAL_FLOOR_RUSTY_2",{row:1,col:10},void 0,void 0),v[27]=N.AddSolidBlock(27,"METAL_FLOOR_RUSTY_3",{row:2,col:8},void 0,void 0),v[19]=N.AddSolidBlock(19,"METAL_PLATE_1",{row:4,col:12},void 0,void 0),v[20]=N.AddSolidBlock(20,"METAL_PLATE_2",{row:4,col:15},void 0,void 0),v[21]=N.AddSolidBlock(21,"METAL_PLATE_3",{row:5,col:9},void 0,void 0),v[43]=N.AddSolidBlock(43,"METAL_PLATE_4",{row:2,col:14},void 0,void 0),v[28]=N.AddSolidBlock(28,"FLOOR_GREEN",{row:0,col:13},void 0,void 0),v[29]=N.AddSolidBlock(29,"FLOOR_BLUE",{row:0,col:14},void 0,void 0),v[30]=N.AddSolidBlock(30,"FLOOR_PURPLE",{row:2,col:13},void 0,void 0),v[31]=N.AddSolidBlock(31,"FLOOR_GREEN_BLUE",{row:5,col:13},void 0,void 0),v[32]=N.AddSolidBlock(32,"CRATE_1",{row:2,col:9},void 0,void 0),v[33]=N.AddSolidBlock(33,"METAL_WALL_1",{row:2,col:15},void 0,void 0),v[34]=N.AddSolidBlock(34,"METAL_WALL_2",{row:5,col:8},void 0,void 0),v[44]=N.AddSolidBlock(44,"METAL_WALL_3",{row:1,col:6},void 0,void 0),v[45]=N.AddSolidBlock(45,"BRICK_WALL_1",{row:4,col:3},void 0,void 0),v[46]=N.AddSolidBlock(46,"BRICK_WALL_2",{row:4,col:4},void 0,void 0),v[47]=N.AddSolidBlock(47,"BRICK_WALL_3",{row:4,col:5},void 0,void 0),v[48]=N.AddSolidBlock(48,"BRICK_WALL_4",{row:4,col:7},void 0,void 0),v[49]=N.AddSolidBlock(49,"BRICK_WALL_5",{row:0,col:4},void 0,void 0),v[50]=N.AddSolidBlock(50,"BRICK_WALL_6",{row:1,col:2},void 0,void 0),v[51]=N.AddSolidBlock(51,"BRICK_WALL_7",{row:2,col:1},void 0,void 0),v[52]=N.AddSolidBlock(52,"WOODEN_WALL_1",{row:1,col:4},void 0,void 0),v[53]=N.AddSolidBlock(53,"WOODEN_WALL_2",{row:5,col:6},void 0,void 0),v[54]=N.AddSolidBlock(54,"WOODEN_WALL_3",{row:5,col:7},void 0,void 0),v[35]=N.AddTransparentBlock(35,"GLASS_PURPLE",{row:3,col:0},void 0,void 0),v[36]=N.AddTransparentBlock(36,"GLASS_PINK",{row:3,col:2},void 0,void 0),v[37]=N.AddTransparentBlock(37,"GLASS_RED",{row:2,col:7},void 0,void 0),v[38]=N.AddTransparentBlock(38,"GLASS_BLUE",{row:4,col:1},void 0,void 0),v[55]=N.AddSolidBlock(55,"CARPET_GREEN",{row:6,col:1},void 0,void 0),v[56]=N.AddSolidBlock(56,"CARPET_BLUE",{row:6,col:5},void 0,void 0),v[57]=N.AddSolidBlock(57,"CARPET_PURPLE",{row:5,col:5},void 0,void 0),v[58]=N.AddSolidBlock(58,"CARPET_DARK_BLUE",{row:5,col:3},void 0,void 0),v[59]=N.AddSolidBlock(59,"CARPET_ORANGE",{row:5,col:1},void 0,void 0),v[60]=N.AddSolidBlock(60,"CARPET_YELLOW",{row:5,col:0},void 0,void 0),v[61]=N.AddTransparentBlock(61,"CLEAN_BRICK_1",{row:2,col:4},void 0,void 0),v[62]=N.AddTransparentBlock(62,"CLEAN_BRICK_2",{row:3,col:5},void 0,void 0),v[63]=N.AddTransparentBlock(63,"WARNING",{row:3,col:7},void 0,void 0);const Nn=N.AddTransparentBlock(41,"SPAWNER_1",{row:3,col:15});Nn.isSolid=!1,v[41]=Nn;const Rn=N.AddTransparentBlock(42,"SPAWNER_2",{row:6,col:15});Rn.isSolid=!1,v[42]=Rn;const Cs={top:"top",bottom:"bottom",left:"side",right:"side",front:"side",back:"side"},Ns=[[0,0,0],[0,1,0],[0,-1,0],[-1,0,0],[-1,1,0],[-1,-1,0],[1,0,0],[1,1,0],[1,-1,0],[0,0,1],[0,1,1],[0,-1,1],[-1,0,1],[-1,1,1],[-1,-1,1],[1,0,1],[1,1,1],[1,-1,1],[0,0,-1],[0,1,-1],[0,-1,-1],[-1,0,-1],[-1,1,-1],[-1,-1,-1],[1,0,-1],[1,1,-1],[1,-1,-1]],yt=class{static isVisibleBlock(t){return t!=null&&t!==B.AIR}static getBlockFaces(){return Object.keys(vn)}static getBlockFaceGeometry(t){return vn[t]}static getNeighbourBlockOffsets(){return Ns}static getBlockMetadata(t){return v[t]}static getBlockColor(t){return v[t].color}static getBlockUVCoordinates(t,e,[r,s]){const i=Cs[e],{row:a,col:u}=v[t].texture[i];return{u:(u+r)*Cn/Is,v:1-(a+1-s)*Cn/vs}}static getBlockFaceFromNormal(t){for(const[e,r]of Object.entries(Pt))if(new D().fromArray(r).equals(t))return e;return null}static getBlockBoundingBoxFromPosition(t){return yt.getBlockBoundingBox(yt.getBlockOriginFromPosition(t))}static getBlockBoundingBox(t){return new In(t,t.clone().addScalar(yt.SIZE))}static getBlockOriginFromPosition(t){return new D(Math.floor(t.x),Math.floor(t.y),Math.floor(t.z))}static toBlockCenterCoord(t){return Math.floor(t/yt.SIZE)*yt.SIZE+yt.SIZE/2}static getBlockNormalFromPosition(t,e){const r=new D(t.x+.5,t.y+.5,t.z+.5),s=Math.abs(e.x-r.x),i=Math.abs(e.y-r.y),a=Math.abs(e.z-r.z),u=new D;return s>i&&s>a?u.set(e.x>r.x?1:-1,0,0):i>a?u.set(0,e.y>r.y?1:-1,0):u.set(0,0,e.z>r.z?1:-1),u}static raycast(t,e,r){let s=e.x-t.x,i=e.y-t.y,a=e.z-t.z;const u=s*s+i*i+a*a,h=Math.sqrt(u);s/=h,i/=h,a/=h;let l=0,o=Math.floor(t.x),c=Math.floor(t.y),d=Math.floor(t.z);const f=s>0?1:-1,p=i>0?1:-1,x=a>0?1:-1,M=Math.abs(1/s),b=Math.abs(1/i),g=Math.abs(1/a),E=f>0?o+1-t.x:t.x-o,w=p>0?c+1-t.y:t.y-c,S=x>0?d+1-t.z:t.z-d;let y=M<1/0?M*E:1/0,L=b<1/0?b*w:1/0,R=g<1/0?g*S:1/0,m=-1;for(;l<=h;){const A=r.getBlock({x:o,y:c,z:d});if(yt.isVisibleBlock(A==null?void 0:A.type))return{position:[t.x+l*s,t.y+l*i,t.z+l*a],normal:[m===0?-f:0,m===1?-p:0,m===2?-x:0],block:A};const C=Math.min(y,L,R);C===y?(o+=f,l=y,y+=M,m=0):C===L?(c+=p,l=L,L+=b,m=1):(d+=x,l=R,R+=g,m=2)}return null}};let At=yt;_(At,"SIZE",1);const G=class{constructor(t,e){_(this,"chunkId");_(this,"worldOriginPosition");_(this,"blocks");_(this,"isDirt");this.chunkId=t,this.worldOriginPosition=G.getChunkOriginPosition(t),this.isDirt=!1,this.blocks=e??new Uint8Array(G.HEIGHT*G.WIDTH*G.WIDTH)}getBlock(t){if(!this.isBlockInChunk(t))return null;const e=this.computeBlockIndex(t),r=this.blocks[e];return{type:r,...v[r]}}setBlock(t,e){if(!this.isBlockInChunk(t))return;const r=this.computeBlockIndex(t);this.blocks[r]=e}isBlockInChunk(t){return G.getChunkIdFromPosition(t)===this.chunkId}decorateChunk(t,e){const{x:r,y:s,z:i}=this.getWorldOriginPosition(),a=r+G.WIDTH,u=s+G.HEIGHT,h=i+G.WIDTH,l=new Map;for(let o=s;o<u;o++)for(let c=i;c<h;c++)for(let d=r;d<a;d++){const f={x:d,y:o,z:c},p=t.generateBlock(d,o,c,e);p&&this.setBlock(f,p)}l.forEach((o,c)=>{for(let d=18;d<=o.y;d++)this.setBlock({x:o.x,y:d,z:o.z},B.OAK_LOG)})}computeBlockIndex({x:t,y:e,z:r}){const[s,i,a]=this.getBlockLocalCoordinates(t,e,r);return i*G.WIDTH*G.WIDTH+a*G.WIDTH+s}computeCoordinatesFromIndex(t){const e=G.WIDTH,r=t%e,s=Math.floor(t/e%e),i=Math.floor(t/(e*e));return{x:r,y:i,z:s}}getBlockLocalCoordinates(t,e,r){const s=Pe.euclideanModulo(t,G.WIDTH)|0,i=Pe.euclideanModulo(e,G.HEIGHT)|0,a=Pe.euclideanModulo(r,G.WIDTH)|0;return[s,i,a]}static buildChunkId({x:t,y:e,z:r}){return`${t},${e},${r}`}static chunkIdAsCoordinate(t){const e=t.match(/^([^,]+),([^,]+),(.+)$/);if(!e)throw new Error("Invalid chunkId");const[r,s,i,a]=e;return{x:Number(s),y:Number(i),z:Number(a)}}static getChunkIdFromPosition({x:t,y:e,z:r}){const s=Math.floor(t/G.WIDTH),i=Math.floor(e/G.HEIGHT),a=Math.floor(r/G.WIDTH);return G.buildChunkId({x:s,y:i,z:a})}static getChunkOriginPosition(t){const{x:e,y:r,z:s}=G.chunkIdAsCoordinate(t),i=e*G.WIDTH,a=r*G.HEIGHT,u=s*G.WIDTH;return{x:i,y:a,z:u}}markAsDirt(){this.isDirt=!0}isDirty(){return this.isDirt}getId(){return this.chunkId}getWorldOriginPosition(){return this.worldOriginPosition}getBlocks(){return this.blocks}_debug(){j.debug(JSON.stringify(this.blocks),j.TERRAIN_KEY)}};let ct=G;_(ct,"WIDTH",O.CHUNK_WIDTH),_(ct,"HEIGHT",O.CHUNK_HEIGHT);const Ke=class{};let pt=Ke;_(pt,"RADIUS",2),_(pt,"TRUNK_HEIGHT",2),_(pt,"MAX_HEIGHT",Ke.TRUNK_HEIGHT+2);class st{constructor(t){_(this,"seed");this.seed=t}getSeed(){return this.seed}}_(st,"getContinentalMapSeed",t=>t+"_continental"),_(st,"getErosionMapSeed",t=>t+"_erosion"),_(st,"getPvMapSeed",t=>t+"_pv"),_(st,"getHeightMapSeed",t=>t+"_height"),_(st,"getDensityMapSeed",t=>t+"_density"),_(st,"getTreeMapSeed",t=>t+"_tree");const ot=class{static generateSeed(){return Math.random().toString(36).substring(2,15)}};let I=ot;_(I,"ORIGIN",new D(0,0,0)),_(I,"CONTINENTALNESS_NOISE_SCALE",2500),_(I,"EROSION_NOISE_SCALE",1024),_(I,"PV_BASE_SCALE",180),_(I,"DENSITY_NOISE_SCALE",12),_(I,"MAX_WORLD_HEIGHT",O.TOP_RENDER_DISTANCE_IN_CHUNKS*O.CHUNK_HEIGHT),_(I,"MIN_WORLD_HEIGHT",O.BOTTOM_RENDER_DISTANCE_IN_CHUNKS*-O.CHUNK_HEIGHT),_(I,"MIN_EROSION",0),_(I,"MAX_EROSION",8),_(I,"MIN_CONTINENTALNESS_HEIGHT",0),_(I,"MAX_CONTINENTALNESS_HEIGHT",25),_(I,"MIN_DENSITY_HEIGHT",ot.MIN_CONTINENTALNESS_HEIGHT-40),_(I,"MAX_DENSITY_HEIGHT",ot.MAX_WORLD_HEIGHT),_(I,"LARGE_CAVES_HEIGHT",0),_(I,"MAX_SURFACE_HEIGHT",ot.MAX_CONTINENTALNESS_HEIGHT+ot.MAX_EROSION),_(I,"MIN_SURFACE_HEIGHT",ot.MIN_CONTINENTALNESS_HEIGHT-ot.MAX_EROSION),_(I,"CLOUD_LEVEL",ot.MAX_SURFACE_HEIGHT-25),_(I,"SNOW_LEVEL",ot.MAX_CONTINENTALNESS_HEIGHT),_(I,"SEA_LEVEL",ot.MIN_CONTINENTALNESS_HEIGHT+15),_(I,"SAND_LEVEL",ot.SEA_LEVEL+6),_(I,"BEDROCK_LEVEL",0),_(I,"CLOUD_WIDTH",10),_(I,"CLOUD_DEPTH",5);const Rs=.5*(Math.sqrt(3)-1),ee=(3-Math.sqrt(3))/6,Os=1/3,ut=1/6,ne=n=>Math.floor(n)|0,On=new Float64Array([1,1,-1,1,1,-1,-1,-1,1,0,-1,0,1,0,-1,0,0,1,0,-1,0,1,0,-1]),Ge=new Float64Array([1,1,0,-1,1,0,1,-1,0,-1,-1,0,1,0,1,-1,0,1,1,0,-1,-1,0,-1,0,1,1,0,-1,1,0,1,-1,0,-1,-1]);function zs(n=Math.random){const t=zn(n),e=new Float64Array(t).map(s=>On[s%12*2]),r=new Float64Array(t).map(s=>On[s%12*2+1]);return function(i,a){let u=0,h=0,l=0;const o=(i+a)*Rs,c=ne(i+o),d=ne(a+o),f=(c+d)*ee,p=c-f,x=d-f,M=i-p,b=a-x;let g,E;M>b?(g=1,E=0):(g=0,E=1);const w=M-g+ee,S=b-E+ee,y=M-1+2*ee,L=b-1+2*ee,R=c&255,m=d&255;let A=.5-M*M-b*b;if(A>=0){const z=R+t[m],k=e[z],P=r[z];A*=A,u=A*A*(k*M+P*b)}let T=.5-w*w-S*S;if(T>=0){const z=R+g+t[m+E],k=e[z],P=r[z];T*=T,h=T*T*(k*w+P*S)}let C=.5-y*y-L*L;if(C>=0){const z=R+1+t[m+1],k=e[z],P=r[z];C*=C,l=C*C*(k*y+P*L)}return 70*(u+h+l)}}function ks(n=Math.random){const t=zn(n),e=new Float64Array(t).map(i=>Ge[i%12*3]),r=new Float64Array(t).map(i=>Ge[i%12*3+1]),s=new Float64Array(t).map(i=>Ge[i%12*3+2]);return function(a,u,h){let l,o,c,d;const f=(a+u+h)*Os,p=ne(a+f),x=ne(u+f),M=ne(h+f),b=(p+x+M)*ut,g=p-b,E=x-b,w=M-b,S=a-g,y=u-E,L=h-w;let R,m,A,T,C,z;S>=y?y>=L?(R=1,m=0,A=0,T=1,C=1,z=0):S>=L?(R=1,m=0,A=0,T=1,C=0,z=1):(R=0,m=0,A=1,T=1,C=0,z=1):y<L?(R=0,m=0,A=1,T=0,C=1,z=1):S<L?(R=0,m=1,A=0,T=0,C=1,z=1):(R=0,m=1,A=0,T=1,C=1,z=0);const k=S-R+ut,P=y-m+ut,U=L-A+ut,V=S-T+2*ut,et=y-C+2*ut,K=L-z+2*ut,$=S-1+3*ut,Tt=y-1+3*ut,Lt=L-1+3*ut,q=p&255,X=x&255,lt=M&255;let ht=.6-S*S-y*y-L*L;if(ht<0)l=0;else{const W=q+t[X+t[lt]];ht*=ht,l=ht*ht*(e[W]*S+r[W]*y+s[W]*L)}let Et=.6-k*k-P*P-U*U;if(Et<0)o=0;else{const W=q+R+t[X+m+t[lt+A]];Et*=Et,o=Et*Et*(e[W]*k+r[W]*P+s[W]*U)}let dt=.6-V*V-et*et-K*K;if(dt<0)c=0;else{const W=q+T+t[X+C+t[lt+z]];dt*=dt,c=dt*dt*(e[W]*V+r[W]*et+s[W]*K)}let Q=.6-$*$-Tt*Tt-Lt*Lt;if(Q<0)d=0;else{const W=q+1+t[X+1+t[lt+1]];Q*=Q,d=Q*Q*(e[W]*$+r[W]*Tt+s[W]*Lt)}return 32*(l+o+c+d)}}function zn(n){const e=new Uint8Array(512);for(let r=0;r<512/2;r++)e[r]=r;for(let r=0;r<512/2-1;r++){const s=r+~~(n()*(256-r)),i=e[r];e[r]=e[s],e[s]=i}for(let r=256;r<512;r++)e[r]=e[r-256];return e}var We={},Ps={get exports(){return We},set exports(n){We=n}};(function(n,t){(function(e,r){n.exports=r()})(F,function(){return e.importState=function(s){var i=new e;return i.importState(s),i},e;function e(){return function(s){var i=0,a=0,u=0,h=1;s.length==0&&(s=[+new Date]);var l=r();i=l(" "),a=l(" "),u=l(" ");for(var o=0;o<s.length;o++)i-=l(s[o]),i<0&&(i+=1),a-=l(s[o]),a<0&&(a+=1),u-=l(s[o]),u<0&&(u+=1);l=null;var c=function(){var d=2091639*i+h*23283064365386963e-26;return i=a,a=u,u=d-(h=d|0)};return c.next=c,c.uint32=function(){return c()*4294967296},c.fract53=function(){return c()+(c()*2097152|0)*11102230246251565e-32},c.version="Alea 0.9",c.args=s,c.exportState=function(){return[i,a,u,h]},c.importState=function(d){i=+d[0]||0,a=+d[1]||0,u=+d[2]||0,h=+d[3]||0},c}(Array.prototype.slice.call(arguments))}function r(){var s=4022871197,i=function(a){a=a.toString();for(var u=0;u<a.length;u++){s+=a.charCodeAt(u);var h=.02519603282416938*s;s=h>>>0,h-=s,h*=s,s=h>>>0,h-=s,s+=h*4294967296}return(s>>>0)*23283064365386963e-26};return i.version="Mash 0.9",i}})})(Ps);class Be{constructor(t){_(this,"seed");_(this,"prng");this.seed=t,this.prng=We(t)}getSeed(){return this.seed}}class Kt extends Be{constructor(e){super(e);_(this,"data");this.data=new Map}getMapData(){return this.data}setMapData(e){this.data=e}getPointData(e,r){const s=Kt.computeKey(e,r);return this.data.get(s)}setPointData(e,r,s){const i=Kt.computeKey(e,r);return this.data.set(i,s),s}static computeKey(e,r){return`${Math.floor(e)}_${Math.floor(r)}`}}class Ue extends Kt{constructor(e){super(e);_(this,"noise2D");this.noise2D=zs(this.prng)}}class J{}_(J,"ENABLED",O.TESTING_MAP_ENABLED),_(J,"CONTINENTALNESS",O.TESTING_MAP_CONTINENTALNESS),_(J,"EROSION",O.TESTING_MAP_EROSION),_(J,"PV",O.TESTING_MAP_PV);const $t=class extends Ue{constructor(t){super(t)}setValueAt(t,e,r){return this.setPointData(t,e,r)}getValueAt(t,e){return this.getContinentalnessAt(t,e)}getContinentalnessAt(t,e){if(J.ENABLED&&J.CONTINENTALNESS!=null)return J.CONTINENTALNESS;const r=this.getPointData(t,e);if(r!=null)return r;const s=this.noise2D(t/I.CONTINENTALNESS_NOISE_SCALE,e/I.CONTINENTALNESS_NOISE_SCALE);return this.setPointData(t,e,s),s}static getType(t){return t<=$t.NoiseRange.Ocean.max?"Ocean":t<=$t.NoiseRange.Coast.max?"Coast":t<=$t.NoiseRange.Near_Inland.max?"Near_Inland":t<=$t.NoiseRange.Inland.max?"Inland":"Far_Inland"}};let it=$t;_(it,"NoiseRange",{Ocean:{min:-1,max:-.7},Coast:{min:-.7,max:-.4},Near_Inland:{min:-.4,max:0},Inland:{min:0,max:.6},Far_Inland:{min:.6,max:1}});class Ee extends Be{constructor(e){super(e);_(this,"data");this.data=new Map}getMapData(){return this.data}setMapData(e){this.data=e}getPointData(e,r,s){const i=Ee.computeKey(e,r,s);return this.data.get(i)}setPointData(e,r,s,i){const a=Ee.computeKey(e,r,s);return this.data.set(a,i),i}static computeKey(e,r,s){return`${Math.floor(e)}_${Math.floor(r)}_${Math.floor(s)}`}}class Ds extends Ee{constructor(e){super(e);_(this,"noise3D");this.noise3D=ks(this.prng)}}const xt=class extends Ue{constructor(t){super(t)}setValueAt(t,e,r){return this.setPointData(t,e,r)}getValueAt(t,e){return this.getErosionAt(t,e)}getErosionAt(t,e){if(J.ENABLED&&J.EROSION!=null)return J.EROSION;const r=this.getPointData(t,e);if(r!=null)return r;const s=this.noise2D(t/I.EROSION_NOISE_SCALE,e/I.EROSION_NOISE_SCALE);return this.setPointData(t,e,s),s}static getType(t){return t<=xt.NoiseRange.VeryLow.max?"VeryLow":t<=xt.NoiseRange.Low.max?"Low":t<=xt.NoiseRange.Mid.max?"Mid":t<=xt.NoiseRange.MidSpike.max?"MidSpike":t<=xt.NoiseRange.MidLow.max?"MidLow":t<=xt.NoiseRange.FlatSpike.max?"FlatSpike":"Flat"}};let Mt=xt;_(Mt,"NoiseRange",{VeryLow:{min:-1,max:-.5},Low:{min:-.5,max:-.1},Mid:{min:-.1,max:.3},MidSpike:{min:.3,max:.4},MidLow:{min:.4,max:.7},FlatSpike:{min:.7,max:.8},Flat:{min:.8,max:1}});const Dt=class extends Ue{constructor(t){super(t)}setValueAt(t,e,r){return this.setPointData(t,e,r)}getValueAt(t,e){return this.getPVAt(t,e)}getPVAt(t,e){if(J.ENABLED&&J.PV!=null)return J.PV;const r=this.getPointData(t,e);if(r!=null)return r;const s=4,i=.5,a=I.PV_BASE_SCALE;let u=0,h=0;for(let l=0;l<s;l++){const o=Math.pow(2,l),c=Math.pow(i,l);h+=c,u+=this.noise2D(t/a*o,e/a*o)*c}return u/=h,this.setPointData(t,e,u),u}static getType(t){return t<=Dt.NoiseRange.Valley.max?"Valley":t<=Dt.NoiseRange.Low.max?"Low":t<=Dt.NoiseRange.Plateau.max?"Plateau":t<=Dt.NoiseRange.Mid.max?"Mid":t<=Dt.NoiseRange.High.max?"High":"Peak"}};let wt=Dt;_(wt,"NoiseRange",{Valley:{min:-1,max:-.7},Low:{min:-.7,max:-.4},Plateau:{min:-.4,max:-.1},Mid:{min:-.1,max:.4},High:{min:.4,max:.8},Peak:{min:.8,max:1}});class Fs extends Ds{constructor(e,r,s){super(e);_(this,"SOLID",1);_(this,"AIR",-1);_(this,"erosionMap");_(this,"pvMap");this.erosionMap=r,this.pvMap=s}setValueAt(e,r,s,i){return this.setPointData(e,r,s,i)}getValueAt(e,r,s){return this.getDensityAt(e,r,s)}getDensityAt(e,r,s){const{AIR:i,SOLID:a}=this;if(r<I.MIN_DENSITY_HEIGHT)return a;if(r>I.MAX_DENSITY_HEIGHT)return i;const u=1,h=1;return this.noise3D(e/u,r/u,s/u)+h}getScaleFactorAt(e,r,s){return r<I.LARGE_CAVES_HEIGHT?256:36}getSquashingFactorAt(e,r,s){const i=this.erosionMap.getValueAt(e,s),a=this.pvMap.getValueAt(e,s),u=Mt.getType(i),h=a>=wt.NoiseRange.Mid.min;switch(u){case"VeryLow":return h?.6:.8;case"Low":return h?.8:.9;case"MidLow":return .9;default:return 1}}}function tt(n,t,e){return Math.round(n+(t-n)*e)}function Hs(n){return Math.random()<=n}function ge(n,t,e){return n>=t&&n<=e}class Gs extends Kt{constructor(e,r,s,i){super(e);_(this,"continentalMap");_(this,"erosionMap");_(this,"pvMap");this.continentalMap=r,this.erosionMap=s,this.pvMap=i}setValueAt(e,r,s){return this.setPointData(e,r,s)}getValueAt(e,r){return this.getSurfaceHeightAt(e,r)}getSurfaceHeightAt(e,r){const s=this.getPointData(e,r);if(s!=null)return s;const i=this.getContinentalness(e,r),a=this.getBaseHeight(i),u=this.getErosion(e,r),h=this.getErosionFactor(u),l=this.getPV(e,r),o=this.getPvHeight(l,h),c=a+o;return this.setPointData(e,r,c),c}getBaseHeight(e){const r=it.getType(e);if(r==="Ocean")return I.MIN_CONTINENTALNESS_HEIGHT;if(r==="Coast"){const s=it.NoiseRange.Coast.min,i=it.NoiseRange.Coast.max,a=(e-s)/(i-s);return tt(I.SEA_LEVEL,I.SEA_LEVEL+2,a)}if(r==="Near_Inland"||r==="Inland"){const s=it.NoiseRange.Near_Inland.min,i=it.NoiseRange.Inland.max,a=(e-s)/(i-s);return tt(I.SEA_LEVEL+2,I.SEA_LEVEL+15,a)}if(r==="Far_Inland"){const s=it.NoiseRange.Far_Inland.min,i=it.NoiseRange.Far_Inland.max,a=(e-s)/(i-s);return tt(I.SEA_LEVEL+15,I.MAX_CONTINENTALNESS_HEIGHT,a)}return I.MAX_CONTINENTALNESS_HEIGHT}getErosionFactor(e){const r=I.MIN_EROSION,s=I.MAX_EROSION,i=Math.floor(s*(1/2)),a=r+6,u=a*2,h=u*2,l=Mt.getType(e),{min:o,max:c}=Mt.NoiseRange[l],d=(e-o)/(c-o),f=(c-e)/(c-o);switch(l){case"Flat":return tt(r,a,f);case"FlatSpike":return tt(a,i,f);case"MidLow":return i;case"MidSpike":return tt(a,i,d);case"Mid":return tt(a,u,f);case"Low":return tt(u,h,f);case"VeryLow":return tt(h,s,f)}}getPvHeight(e,r){const s=Math.round(-r*.6666666666666666),i=Math.round(-r/4),a=r,u=Math.round(a*(1/2)),h=wt.getType(e),{min:l,max:o}=wt.NoiseRange[h],c=(e-l)/(o-l);switch(h){case"Valley":return s;case"Low":return tt(s,i,c);case"Plateau":return tt(i,i+2,c);case"Mid":return tt(i+2,u,c);case"High":return tt(u,a,c);case"Peak":return a}}getContinentalness(e,r){return this.continentalMap.getValueAt(e,r)}getErosion(e,r){return this.erosionMap.getValueAt(e,r)}getPV(e,r){return this.pvMap.getValueAt(e,r)}}class Ws extends Be{constructor(e,r,s,i,a,u){super(e);_(this,"continentalMap");_(this,"erosionMap");_(this,"pvMap");_(this,"heightMap");_(this,"densityMap");this.continentalMap=r,this.erosionMap=s,this.pvMap=i,this.heightMap=a,this.densityMap=u}getSurfaceHeightAt(e,r){return Math.floor(this.heightMap.getValueAt(e,r)*.25)}getContinentalnessAt(e,r){return this.continentalMap.getValueAt(e,r)}getErosionAt(e,r){return this.erosionMap.getValueAt(e,r)}getPVAt(e,r){return this.pvMap.getValueAt(e,r)}getDensityAt(e,r,s){return this.densityMap.getValueAt(e,r,s)}getHeightMap(){return this.heightMap}}var re=(n=>(n[n.EMPTY=0]="EMPTY",n[n.TRUNK=1]="TRUNK",n[n.LEAF=2]="LEAF",n))(re||{});class Yt{static encode(t){let e=0;return e=this.setType(e,t.type),e=this.setTrunkHeight(e,t.trunkHeight),e=this.setTrunkSurfaceY(e,t.trunkSurfaceY),e=this.setTrunkDistance(e,t.trunkDistance),e}static decode(t){return{type:this.getType(t),trunkHeight:this.getTrunkHeight(t),trunkSurfaceY:this.getTrunkSurfaceY(t),trunkDistance:this.getTrunkDistance(t)}}static getType(t){return(t&this.TYPE_MASK)>>14}static setType(t,e){return t|=e<<14&this.TYPE_MASK}static getTrunkHeight(t){return(t&this.TRUNK_HEIGHT_MASK)>>10}static setTrunkHeight(t,e){return t|=e<<10&this.TRUNK_HEIGHT_MASK}static getTrunkSurfaceY(t){return(t&this.TRUNK_SURFACE_HEIGHT_MASK)>>2}static setTrunkSurfaceY(t,e){return t|=e<<2&this.TRUNK_SURFACE_HEIGHT_MASK}static getTrunkDistance(t){return t&this.TRUNK_DISTANCE_MASK}static setTrunkDistance(t,e){return t|=e&this.TRUNK_DISTANCE_MASK}}_(Yt,"TYPE_MASK",49152),_(Yt,"TRUNK_HEIGHT_MASK",15360),_(Yt,"TRUNK_SURFACE_HEIGHT_MASK",1020),_(Yt,"TRUNK_DISTANCE_MASK",3);class se extends Kt{constructor(e){super(e);_(this,"enabled");this.enabled=O.TREE_GENERATION_ENABLED}shouldSpawnTreeLeafAt(e,r,s){if(!this.enabled)return!1;const i=this.getTreeMapValueAt(e,s);if(i==null)return!1;const{type:a,trunkDistance:u,trunkHeight:h,trunkSurfaceY:l}=Yt.decode(i),o=l+h,c=r-o;if(a===re.TRUNK){if(c===2)return Hs(.5);if(c===1)return!0}return!!(a===re.LEAF&&(u===2&&ge(c,-1,0)||u===1&&ge(c,-1,1)))}shouldSpawnTreeTrunkAt(e,r,s,i){if(!this.enabled)return!1;const a=this.getTreeMapTypeAt(e,s);return r<i||r>i+pt.TRUNK_HEIGHT||a==null?!1:a===re.TRUNK}getTreeMapTypeAt(e,r){const s=this.getTreeMapValueAt(e,r);return s!=null?Yt.getType(s):null}getTreeMapValueAt(e,r){return this.getPointData(e,r)}static getTreeSeedAt(e,r,s){return`${e}_${r}_${s}`}setValueAt(e,r,s){return this.setPointData(e,r,s)}getValueAt(e,r){return this.getPointData(e,r)??re.EMPTY}}_(se,"MAP_SIZE",ct.WIDTH+pt.RADIUS*2);class Bs extends st{constructor(t){super(t)}getTerrainMap(){const{seed:t}=this,e=new it(st.getContinentalMapSeed(t)),r=new Mt(st.getErosionMapSeed(t)),s=new wt(st.getPvMapSeed(t)),i=new Gs(st.getHeightMapSeed(t),e,r,s),a=new Fs(st.getDensityMapSeed(t),r,s);return new Ws(t,e,r,s,i,a)}getTreeMapFromBuffer(t,e){const{x:r,z:s}=ct.getChunkOriginPosition(t),i=new se(this.seed),a=new Map,u=r-pt.RADIUS,h=s-pt.RADIUS;for(let l=0;l<e.length;l++){const o=Math.floor(l/se.MAP_SIZE)+u,c=l%se.MAP_SIZE+h,d=se.computeKey(o,c);a.set(d,e[l])}return i.setMapData(a),i}}class kn{constructor(t){_(this,"terrainMap");this.terrainMap=t}getSurfaceHeightAt(t,e){return this.terrainMap.getSurfaceHeightAt(t,e)}getContinentalTypeAt(t,e){const r=this.terrainMap.getContinentalnessAt(t,e);return it.getType(r)}getPvTypeAt(t,e){const r=this.terrainMap.getPVAt(t,e);return wt.getType(r)}getErosionTypeAt(t,e){const r=this.terrainMap.getErosionAt(t,e);return Mt.getType(r)}}class Us extends kn{constructor(e,r){super(e);_(this,"treeMap");this.treeMap=r}generateBlock(e,r,s){if(!(Math.abs(e-0)<100&&Math.abs(s-0)<100))return null;const o=this.getSurfaceHeightAt(e,s);return r<o?null:this.shouldSpawnWater(e,r,s)?B.WATER:this.treeMap.shouldSpawnTreeTrunkAt(e,r,s,o)?B.OAK_LOG:this.treeMap.shouldSpawnTreeLeafAt(e,r,s)?B.OAK_LEAVES:this.shouldSpawnCloud(e,r,s)?B.CLOUD:B.AIR}shouldSpawnWater(e,r,s){return r<I.SEA_LEVEL}shouldSpawnCloud(e,r,s){const i=Math.floor(Math.random()*6)+1,a=r>I.CLOUD_LEVEL&&r<=I.CLOUD_LEVEL+1,u=Math.ceil(e/I.CLOUD_WIDTH)%i===0&&Math.ceil(s/I.CLOUD_DEPTH)%i===0;return a&&u}}var Ve={},Vs={get exports(){return Ve},set exports(n){Ve=n}};(function(n){(function(t){function e(l){function o(c,d,f){this.x=c,this.y=d,this.z=f}o.prototype.dot2=function(c,d){return this.x*c+this.y*d},o.prototype.dot3=function(c,d,f){return this.x*c+this.y*d+this.z*f},this.grad3=[new o(1,1,0),new o(-1,1,0),new o(1,-1,0),new o(-1,-1,0),new o(1,0,1),new o(-1,0,1),new o(1,0,-1),new o(-1,0,-1),new o(0,1,1),new o(0,-1,1),new o(0,1,-1),new o(0,-1,-1)],this.p=[151,160,137,91,90,15,131,13,201,95,96,53,194,233,7,225,140,36,103,30,69,142,8,99,37,240,21,10,23,190,6,148,247,120,234,75,0,26,197,62,94,252,219,203,117,35,11,32,57,177,33,88,237,149,56,87,174,20,125,136,171,168,68,175,74,165,71,134,139,48,27,166,77,146,158,231,83,111,229,122,60,211,133,230,220,105,92,41,55,46,245,40,244,102,143,54,65,25,63,161,1,216,80,73,209,76,132,187,208,89,18,169,200,196,135,130,116,188,159,86,164,100,109,198,173,186,3,64,52,217,226,250,124,123,5,202,38,147,118,126,255,82,85,212,207,206,59,227,47,16,58,17,182,189,28,42,223,183,170,213,119,248,152,2,44,154,163,70,221,153,101,155,167,43,172,9,129,22,39,253,19,98,108,110,79,113,224,232,178,185,112,104,218,246,97,228,251,34,242,193,238,210,144,12,191,179,162,241,81,51,145,235,249,14,239,107,49,192,214,31,181,199,106,157,184,84,204,176,115,121,50,45,127,4,150,254,138,236,205,93,222,114,67,29,24,72,243,141,128,195,78,66,215,61,156,180],this.perm=new Array(512),this.gradP=new Array(512),this.seed(l||0)}e.prototype.seed=function(l){l>0&&l<1&&(l*=65536),l=Math.floor(l),l<256&&(l|=l<<8);for(var o=this.p,c=0;c<256;c++){var d;c&1?d=o[c]^l&255:d=o[c]^l>>8&255;var f=this.perm,p=this.gradP;f[c]=f[c+256]=d,p[c]=p[c+256]=this.grad3[d%12]}};var r=.5*(Math.sqrt(3)-1),s=(3-Math.sqrt(3))/6,i=1/3,a=1/6;e.prototype.simplex2=function(l,o){var c,d,f,p=(l+o)*r,x=Math.floor(l+p),M=Math.floor(o+p),b=(x+M)*s,g=l-x+b,E=o-M+b,w,S;g>E?(w=1,S=0):(w=0,S=1);var y=g-w+s,L=E-S+s,R=g-1+2*s,m=E-1+2*s;x&=255,M&=255;var A=this.perm,T=this.gradP,C=T[x+A[M]],z=T[x+w+A[M+S]],k=T[x+1+A[M+1]],P=.5-g*g-E*E;P<0?c=0:(P*=P,c=P*P*C.dot2(g,E));var U=.5-y*y-L*L;U<0?d=0:(U*=U,d=U*U*z.dot2(y,L));var V=.5-R*R-m*m;return V<0?f=0:(V*=V,f=V*V*k.dot2(R,m)),70*(c+d+f)},e.prototype.simplex3=function(l,o,c){var d,f,p,x,M=(l+o+c)*i,b=Math.floor(l+M),g=Math.floor(o+M),E=Math.floor(c+M),w=(b+g+E)*a,S=l-b+w,y=o-g+w,L=c-E+w,R,m,A,T,C,z;S>=y?y>=L?(R=1,m=0,A=0,T=1,C=1,z=0):S>=L?(R=1,m=0,A=0,T=1,C=0,z=1):(R=0,m=0,A=1,T=1,C=0,z=1):y<L?(R=0,m=0,A=1,T=0,C=1,z=1):S<L?(R=0,m=1,A=0,T=0,C=1,z=1):(R=0,m=1,A=0,T=1,C=1,z=0);var k=S-R+a,P=y-m+a,U=L-A+a,V=S-T+2*a,et=y-C+2*a,K=L-z+2*a,$=S-1+3*a,Tt=y-1+3*a,Lt=L-1+3*a;b&=255,g&=255,E&=255;var q=this.perm,X=this.gradP,lt=X[b+q[g+q[E]]],ht=X[b+R+q[g+m+q[E+A]]],Et=X[b+T+q[g+C+q[E+z]]],dt=X[b+1+q[g+1+q[E+1]]],Q=.5-S*S-y*y-L*L;Q<0?d=0:(Q*=Q,d=Q*Q*lt.dot3(S,y,L));var W=.5-k*k-P*P-U*U;W<0?f=0:(W*=W,f=W*W*ht.dot3(k,P,U));var It=.5-V*V-et*et-K*K;It<0?p=0:(It*=It,p=It*It*Et.dot3(V,et,K));var Ft=.5-$*$-Tt*Tt-Lt*Lt;return Ft<0?x=0:(Ft*=Ft,x=Ft*Ft*dt.dot3($,Tt,Lt)),32*(d+f+p+x)};function u(l){return l*l*l*(l*(l*6-15)+10)}function h(l,o,c){return(1-c)*l+c*o}e.prototype.perlin2=function(l,o){var c=Math.floor(l),d=Math.floor(o);l=l-c,o=o-d,c=c&255,d=d&255;var f=this.perm,p=this.gradP,x=p[c+f[d]].dot2(l,o),M=p[c+f[d+1]].dot2(l,o-1),b=p[c+1+f[d]].dot2(l-1,o),g=p[c+1+f[d+1]].dot2(l-1,o-1),E=u(l);return h(h(x,b,E),h(M,g,E),u(o))},e.prototype.perlin3=function(l,o,c){var d=Math.floor(l),f=Math.floor(o),p=Math.floor(c);l=l-d,o=o-f,c=c-p,d=d&255,f=f&255,p=p&255;var x=this.perm,M=this.gradP,b=M[d+x[f+x[p]]].dot3(l,o,c),g=M[d+x[f+x[p+1]]].dot3(l,o,c-1),E=M[d+x[f+1+x[p]]].dot3(l,o-1,c),w=M[d+x[f+1+x[p+1]]].dot3(l,o-1,c-1),S=M[d+1+x[f+x[p]]].dot3(l-1,o,c),y=M[d+1+x[f+x[p+1]]].dot3(l-1,o,c-1),L=M[d+1+x[f+1+x[p]]].dot3(l-1,o-1,c),R=M[d+1+x[f+1+x[p+1]]].dot3(l-1,o-1,c-1),m=u(l),A=u(o),T=u(c);return h(h(h(b,S,m),h(g,y,m),T),h(h(E,L,m),h(w,R,m),T),A)},t.Noise=e})(n.exports)})(Vs);class Pn extends kn{constructor(t){super(t)}generateBlock(t,e,r,s){if(Math.hypot(t-0,r-0)>=s)return B.AIR;const h=this.getSurfaceHeightAt(t,r);if(this.terrainMap.getDensityAt(t,e,r)<0||e>=h)return B.AIR;const o=Math.abs(e-h);switch(this.getDepthLevel(e,o)){case"Surface":return this.getSurfaceBlockType(t,e,r);case"Subsurface":return this.getSubSurfaceBlockType(t,e,r);case"Mid":return this.getMidBlockType(t,e,r,o);default:return B.STONE}}getMidBlockType(t,e,r,s){return B.STONE}getSurfaceBlockType(t,e,r){return this.shouldSpawnSnow(t,e,r)?B.GRASS_SNOW:this.shouldSpawnSand(t,e,r)?B.SAND:e<I.SEA_LEVEL-1?B.DIRT:this.shouldSpawnSurfaceStone(t,e,r)?B.STONE:B.GRASS}getSubSurfaceBlockType(t,e,r){return this.shouldSpawnSurfaceStone(t,e,r)?B.STONE:B.DIRT}shouldSpawnSand(t,e,r){const s=this.getContinentalTypeAt(t,r);return e<=I.SAND_LEVEL&&(s==="Coast"||s==="Ocean")}shouldSpawnSurfaceStone(t,e,r){const s=this.getPvTypeAt(t,r),i=this.getContinentalTypeAt(t,r),a=this.getErosionTypeAt(t,r),u=i==="Far_Inland",h=i==="Inland",l=a==="Flat",o=a==="VeryLow"||a==="Low",c=a==="VeryLow",d=s==="Valley",f=s==="Valley"||s==="Low";return u&&c&&f||u&&o&&d||(h||u)&&l&&f}shouldSpawnCoal(t,e,r,s){const i=this.terrainMap.getDensityAt(t,e,r),a=ge(i,.05,.07);return ge(s,5,20)&&a}shouldSpawnSnow(t,e,r){const i=this.getContinentalTypeAt(t,r)==="Far_Inland",a=e>=I.SNOW_LEVEL;return i&&a}getDepthLevel(t,e){return e<=1?"Surface":e<=3?"Subsurface":t<=I.BEDROCK_LEVEL?"BedRock":t<=I.MIN_SURFACE_HEIGHT-5?"Deep":"Mid"}}_(Pn,"noise",new Ve.Noise(1));var Dn=(n=>(n[n.TERRAIN=0]="TERRAIN",n[n.FEATURES=1]="FEATURES",n))(Dn||{});class js{constructor(t,e){_(this,"terrainGenerator");_(this,"featuresGenerator");this.terrainGenerator=new Pn(t),this.featuresGenerator=new Us(t,e)}getBlockGenerator(t){switch(t){case 0:return this.terrainGenerator;case 1:return this.featuresGenerator}}}class Ks{constructor(t){_(this,"DEFAULT_BLOCK_COLOR_RGBA",[1,1,1,1]);_(this,"AO_INTENSITY_LEVEL",[0,.2,.3,.4]);_(this,"terrainMap");this.terrainMap=t}buildChunkGeometry(t,e){const{x:r,y:s,z:i}=e,a=[],u=[],h=[],l=[],o=[],c=[],d=[],f=[],p=[],x=[];for(let M=0;M<ct.HEIGHT;++M){const b=s+M;for(let g=0;g<ct.WIDTH;++g){const E=i+g;for(let w=0;w<ct.WIDTH;++w){const S=r+w,y={x:S,y:b,z:E},L=t.getBlock(y),R=At.isVisibleBlock(L==null?void 0:L.type);if(L&&R){const m=L.isTransparent,A=L.type===B.WATER;if(A&&this.canSkipWaterBlockRendering(b))continue;const T=m?c:a,C=m?d:u,z=m?f:h,k=m?p:l,P=m?x:o;for(const U of At.getBlockFaces()){if(A&&U!=="top")continue;const{normal:V,vertices:et}=At.getBlockFaceGeometry(U),K={x:S+V[0],y:b+V[1],z:E+V[2]},$=t.getBlock(K);if(O.TERRAIN_OPTIMIZATION_ENABLED&&!$&&this.canCullEdgeBlockFace(y,U,K))continue;if(!$||$.isTransparent&&$.type!==B.CLOUD){const X=T.length/3;for(const{pos:lt,uv:ht,ao:Et}of et){const dt=S+lt[0],Q=b+lt[1],W=E+lt[2];T.push(dt,Q,W),C.push(...V);const It=At.getBlockUVCoordinates(L.type,U,[ht[0],ht[1]]);k.push(It.u,It.v);const Ft=this.calculateVertexColor({x:dt,y:Q,z:W},L,Et,t);P.push(...Ft)}z.push(X,X+1,X+2,X+2,X+1,X+3)}}}}}}return{solid:{positions:a,normals:u,indices:h,uvs:l,colors:o},transparent:{positions:c,normals:d,indices:f,uvs:p,colors:x}}}canCullEdgeBlockFace(t,e,r){const{terrainMap:s}=this,{x:i,y:a,z:u}=t,{x:h,y:l,z:o}=r,c=s.getSurfaceHeightAt(h,o);if(!(a<c-(e==="top"?1:0)))return!1;const f=s.getDensityAt(i,a,u),p=s.getDensityAt(h,l,o);return Math.sign(f)===Math.sign(p)}calculateVertexColor(t,e,r,s){const i=At.getBlockColor(e.type)??this.DEFAULT_BLOCK_COLOR_RGBA,a=this.computeVertexAO(t,r,s);return[i[0]-a,i[1]-a,i[2]-a,i[3]]}computeVertexAO(t,{corner:e,side1:r,side2:s},i){let a=0;for(const u of[e,r,s])this.isSideOccluded(t,u,i)&&(a+=1);return this.AO_INTENSITY_LEVEL[a]}isSideOccluded({x:t,y:e,z:r},s,i){const{terrainMap:a}=this,[u,h,l]=s,o=i.getBlock({x:t+u,y:e+h,z:r+l});if(o&&!o.isTransparent)return!0;if(!o){const c=Math.floor(t+u),d=Math.floor(e+h),f=Math.floor(r+l),p=a.getSurfaceHeightAt(c,f),x=a.getDensityAt(c,d,f),M=Math.sign(x)>0,b=Math.sign(h)>0,g=Math.sign(h)<0,E=e<p,w=Math.abs(e-p)===0;if(M)return b&&E||g&&w}return!1}canSkipWaterBlockRendering(t){return t!==I.SEA_LEVEL-1}static extractBufferGeometryDataFromGeometry(t){var u,h;const e=Array.from(t.getAttribute("position").array),r=Array.from(t.getAttribute("normal").array),s=Array.from(t.getAttribute("uv").array),i=Array.from(((u=t.getAttribute("color"))==null?void 0:u.array)??[]),a=Array.from(((h=t.index)==null?void 0:h.array)??[]);return{positions:e,normals:r,uvs:s,indices:a,colors:i}}}function Ys(n,t,e,r){const s=new ct(n),i=new Bs(t),a=i.getTerrainMap(),u=i.getTreeMapFromBuffer(n,new Uint16Array(e)),l=new js(a,u).getBlockGenerator(Dn.TERRAIN);s.decorateChunk(l,r);const o=s.getBlocks(),c=new Ks(a),{solid:d,transparent:f}=c.buildChunkGeometry(s,s.getWorldOriginPosition());return{solidGeometry:d,transparentGeometry:f,blocksBuffer:os(o.buffer)}}as(Ys)})();
